<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Simulating an Experiment from Scratch · MixedModelsSim.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">MixedModelsSim.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">MixedModelsSim.jl</a></li><li class="is-active"><a class="tocitem" href>Simulating an Experiment from Scratch</a><ul class="internal"><li><a class="tocitem" href="#Assemble-the-Design"><span>Assemble the Design</span></a></li><li><a class="tocitem" href="#Assemble-the-Random-Effects"><span>Assemble the Random Effects</span></a></li><li><a class="tocitem" href="#Assemble-the-Fixed-Effects"><span>Assemble the Fixed Effects</span></a></li><li><a class="tocitem" href="#Simulate"><span>Simulate</span></a></li><li><a class="tocitem" href="#See-your-power-and-profit!"><span>See your power and profit!</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Simulating an Experiment from Scratch</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Simulating an Experiment from Scratch</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/RePsychLing/MixedModelsSim.jl/blob/master/docs/src/simulation.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Simulating-an-Experiment-from-Scratch"><a class="docs-heading-anchor" href="#Simulating-an-Experiment-from-Scratch">Simulating an Experiment from Scratch</a><a id="Simulating-an-Experiment-from-Scratch-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-an-Experiment-from-Scratch" title="Permalink"></a></h1><p>Here is a worked example of simulating a partially crossed design from scratch.</p><p>First, some setup:</p><pre><code class="language-julia">using DataFrames
using MixedModels, MixedModelsSim
using Random</code></pre><h2 id="Assemble-the-Design"><a class="docs-heading-anchor" href="#Assemble-the-Design">Assemble the Design</a><a id="Assemble-the-Design-1"></a><a class="docs-heading-anchor-permalink" href="#Assemble-the-Design" title="Permalink"></a></h2><p>We&#39;re going to do a 2 x 2 x 2 design. For concreteness, let&#39;s think of this as a linguistic design:</p><ul><li><strong>age</strong> <code>old</code> vs. <code>young</code>, <em>between subjects</em></li><li><strong>frequency</strong> <code>high</code> vs. <code>low</code>, <em>between items</em></li><li><strong>context</strong> <code>matched</code> vs. <code>unmatched</code>, <em>within both</em>.</li></ul><p>Further, let&#39;s assume we want 40 subjects and 80 items. We can specify this design as follows:</p><pre><code class="language-julia">n_subj = 40
n_item = 80
subj_btwn = Dict(:age =&gt; [&quot;old&quot;, &quot;young&quot;])
item_btwn = Dict(:frequency =&gt; [&quot;high&quot;, &quot;low&quot;])
both_win = Dict(:context =&gt; [&quot;matched&quot;, &quot;unmatched&quot;])</code></pre><pre class="documenter-example-output">Dict{Symbol, Vector{String}} with 1 entry:
  :context =&gt; [&quot;matched&quot;, &quot;unmatched&quot;]</pre><p>and then generate it:</p><pre><code class="language-julia">rng = MersenneTwister(42)  # specify our random number generator for reproducibility
design = simdat_crossed(rng, n_subj, n_item;
                        subj_btwn = subj_btwn,
                        item_btwn = item_btwn,
                        both_win = both_win)</code></pre><pre class="documenter-example-output">6400-element Vector{NamedTuple{(:subj, :age, :item, :frequency, :context, :dv), Tuple{String, String, String, String, String, Float64}}}:
 (subj = &quot;S01&quot;, age = &quot;old&quot;, item = &quot;I01&quot;, frequency = &quot;high&quot;, context = &quot;matched&quot;, dv = -0.5560268761463861)
 (subj = &quot;S02&quot;, age = &quot;young&quot;, item = &quot;I01&quot;, frequency = &quot;high&quot;, context = &quot;matched&quot;, dv = -0.444383357109696)
 (subj = &quot;S03&quot;, age = &quot;old&quot;, item = &quot;I01&quot;, frequency = &quot;high&quot;, context = &quot;matched&quot;, dv = 0.027155338009193845)
 (subj = &quot;S04&quot;, age = &quot;young&quot;, item = &quot;I01&quot;, frequency = &quot;high&quot;, context = &quot;matched&quot;, dv = -0.29948409035891055)
 (subj = &quot;S05&quot;, age = &quot;old&quot;, item = &quot;I01&quot;, frequency = &quot;high&quot;, context = &quot;matched&quot;, dv = 1.7778610980573246)
 (subj = &quot;S06&quot;, age = &quot;young&quot;, item = &quot;I01&quot;, frequency = &quot;high&quot;, context = &quot;matched&quot;, dv = -1.14490153172882)
 (subj = &quot;S07&quot;, age = &quot;old&quot;, item = &quot;I01&quot;, frequency = &quot;high&quot;, context = &quot;matched&quot;, dv = -0.46860588216767457)
 (subj = &quot;S08&quot;, age = &quot;young&quot;, item = &quot;I01&quot;, frequency = &quot;high&quot;, context = &quot;matched&quot;, dv = 0.15614346264074028)
 (subj = &quot;S09&quot;, age = &quot;old&quot;, item = &quot;I01&quot;, frequency = &quot;high&quot;, context = &quot;matched&quot;, dv = -2.641991008076796)
 (subj = &quot;S10&quot;, age = &quot;young&quot;, item = &quot;I01&quot;, frequency = &quot;high&quot;, context = &quot;matched&quot;, dv = 1.0033099014594844)
 ⋮
 (subj = &quot;S32&quot;, age = &quot;young&quot;, item = &quot;I80&quot;, frequency = &quot;low&quot;, context = &quot;unmatched&quot;, dv = -0.0720635904250138)
 (subj = &quot;S33&quot;, age = &quot;old&quot;, item = &quot;I80&quot;, frequency = &quot;low&quot;, context = &quot;unmatched&quot;, dv = -0.5636260084084584)
 (subj = &quot;S34&quot;, age = &quot;young&quot;, item = &quot;I80&quot;, frequency = &quot;low&quot;, context = &quot;unmatched&quot;, dv = -0.48302653966207154)
 (subj = &quot;S35&quot;, age = &quot;old&quot;, item = &quot;I80&quot;, frequency = &quot;low&quot;, context = &quot;unmatched&quot;, dv = 0.5635515836664501)
 (subj = &quot;S36&quot;, age = &quot;young&quot;, item = &quot;I80&quot;, frequency = &quot;low&quot;, context = &quot;unmatched&quot;, dv = -1.5342115330081054)
 (subj = &quot;S37&quot;, age = &quot;old&quot;, item = &quot;I80&quot;, frequency = &quot;low&quot;, context = &quot;unmatched&quot;, dv = -0.7925886663164663)
 (subj = &quot;S38&quot;, age = &quot;young&quot;, item = &quot;I80&quot;, frequency = &quot;low&quot;, context = &quot;unmatched&quot;, dv = 1.1344191438635207)
 (subj = &quot;S39&quot;, age = &quot;old&quot;, item = &quot;I80&quot;, frequency = &quot;low&quot;, context = &quot;unmatched&quot;, dv = 1.3406462534138157)
 (subj = &quot;S40&quot;, age = &quot;young&quot;, item = &quot;I80&quot;, frequency = &quot;low&quot;, context = &quot;unmatched&quot;, dv = 0.7969024201220799)</pre><p>Note that <code>simdat_crossed</code> returns a row table, which <code>MixedModels.jl</code> can process directly. For nicely displaying it, we can again use <code>pretty_table</code>:</p><pre><code class="language-julia">pretty_table(first(design, 5))</code></pre><pre class="documenter-example-output">┌────────┬────────┬────────┬───────────┬─────────┬───────────┐
│   subj │    age │   item │ frequency │ context │        dv │
│ String │ String │ String │    String │  String │   Float64 │
├────────┼────────┼────────┼───────────┼─────────┼───────────┤
│    S01 │    old │    I01 │      high │ matched │ -0.556027 │
│    S02 │  young │    I01 │      high │ matched │ -0.444383 │
│    S03 │    old │    I01 │      high │ matched │ 0.0271553 │
│    S04 │  young │    I01 │      high │ matched │ -0.299484 │
│    S05 │    old │    I01 │      high │ matched │   1.77786 │
└────────┴────────┴────────┴───────────┴─────────┴───────────┘</pre><p>We can also convert it to a DataFrame and change the factors to use pooled arrays to save a bit of memory.</p><pre><code class="language-julia">df = pooled!(DataFrame(design))
first(df, 5)</code></pre><table class="data-frame"><thead><tr><th></th><th>subj</th><th>age</th><th>item</th><th>frequency</th><th>context</th><th>dv</th></tr><tr><th></th><th>String</th><th>String</th><th>String</th><th>String</th><th>String</th><th>Float64</th></tr></thead><tbody><p>5 rows × 6 columns</p><tr><th>1</th><td>S01</td><td>old</td><td>I01</td><td>high</td><td>matched</td><td>-0.556027</td></tr><tr><th>2</th><td>S02</td><td>young</td><td>I01</td><td>high</td><td>matched</td><td>-0.444383</td></tr><tr><th>3</th><td>S03</td><td>old</td><td>I01</td><td>high</td><td>matched</td><td>0.0271553</td></tr><tr><th>4</th><td>S04</td><td>young</td><td>I01</td><td>high</td><td>matched</td><td>-0.299484</td></tr><tr><th>5</th><td>S05</td><td>old</td><td>I01</td><td>high</td><td>matched</td><td>1.77786</td></tr></tbody></table><p>Note that <code>simdat_crossed</code> generated a column <code>dv</code> for our dependent variable that has been pre-populated with noise from a standard normal distribution (<span>$N(0,1)$</span>). Typically, we will want to scale that, but we can do that in the simulation step. Also, this dependent variable is <em>pure noise</em>: we haven&#39;t yet added in effects. Adding in effects also comes in the simulation step.</p><p>But before we get to simulating, let&#39;s fit the model to the noise, just to see how things look. We&#39;re going to use effects coding for our contrasts.</p><pre><code class="language-julia">contrasts = Dict(:age =&gt; EffectsCoding(base=&quot;young&quot;),
                 :frequency =&gt; EffectsCoding(base=&quot;high&quot;),
                 :context =&gt; EffectsCoding(base=&quot;matched&quot;))
form = @formula(dv ~ 1 + age * frequency * context +
                    (1 + frequency + context | subj) +
                    (1 + age + context | item))
m0 = fit(MixedModel, form, design; contrasts=contrasts)</code></pre><table><tr><th align="left"></th><th align="right">Est.</th><th align="right">SE</th><th align="right">z</th><th align="right">p</th><th align="right">σ_item</th><th align="right">σ_subj</th></tr><tr><td align="left">&#40;Intercept&#41;</td><td align="right">-0.0168</td><td align="right">0.0128</td><td align="right">-1.31</td><td align="right">0.1895</td><td align="right">0.0094</td><td align="right">0.0111</td></tr><tr><td align="left">age: old</td><td align="right">-0.0004</td><td align="right">0.0128</td><td align="right">-0.03</td><td align="right">0.9734</td><td align="right">0.0106</td><td align="right"> </td></tr><tr><td align="left">frequency: low</td><td align="right">0.0180</td><td align="right">0.0131</td><td align="right">1.37</td><td align="right">0.1696</td><td align="right"> </td><td align="right">0.0217</td></tr><tr><td align="left">context: unmatched</td><td align="right">0.0099</td><td align="right">0.0132</td><td align="right">0.75</td><td align="right">0.4534</td><td align="right">0.0062</td><td align="right">0.0245</td></tr><tr><td align="left">age: old &amp; frequency: low</td><td align="right">0.0014</td><td align="right">0.0131</td><td align="right">0.11</td><td align="right">0.9147</td><td align="right"> </td><td align="right"> </td></tr><tr><td align="left">age: old &amp; context: unmatched</td><td align="right">0.0068</td><td align="right">0.0132</td><td align="right">0.51</td><td align="right">0.6089</td><td align="right"> </td><td align="right"> </td></tr><tr><td align="left">frequency: low &amp; context: unmatched</td><td align="right">-0.0084</td><td align="right">0.0126</td><td align="right">-0.67</td><td align="right">0.5043</td><td align="right"> </td><td align="right"> </td></tr><tr><td align="left">age: old &amp; frequency: low &amp; context: unmatched</td><td align="right">0.0000</td><td align="right">0.0126</td><td align="right">0.00</td><td align="right">0.9972</td><td align="right"> </td><td align="right"> </td></tr><tr><td align="left">Residual</td><td align="right">1.0095</td><td align="right"></td><td align="right"></td><td align="right"></td><td align="right"></td><td align="right"></td></tr></table>
<h2 id="Assemble-the-Random-Effects"><a class="docs-heading-anchor" href="#Assemble-the-Random-Effects">Assemble the Random Effects</a><a id="Assemble-the-Random-Effects-1"></a><a class="docs-heading-anchor-permalink" href="#Assemble-the-Random-Effects" title="Permalink"></a></h2><p>The hard part in simulating right now is specifying the random effects. We&#39;re working on making this bit easier, but you need to specify the variance-covariance matrix of the random effects. You can see what this looks like:</p><pre><code class="language-julia">vc = VarCorr(m0)</code></pre><table><tr><th align="left"> </th><th align="left">Column</th><th align="right"> Variance</th><th align="right">Std.Dev</th><th align="right">Corr.</th><th align="right"> </th></tr><tr><td align="left">item</td><td align="left">&#40;Intercept&#41;</td><td align="right">0.00008901</td><td align="right">0.00943431</td><td align="right"> </td><td align="right"> </td></tr><tr><td align="left"> </td><td align="left">age: old</td><td align="right">0.00011326</td><td align="right">0.01064260</td><td align="right">&#43;1.00</td><td align="right"> </td></tr><tr><td align="left"> </td><td align="left">context: unmatched</td><td align="right">0.00003830</td><td align="right">0.00618856</td><td align="right">-1.00</td><td align="right">-1.00</td></tr><tr><td align="left">subj</td><td align="left">&#40;Intercept&#41;</td><td align="right">0.00012370</td><td align="right">0.01112210</td><td align="right"> </td><td align="right"> </td></tr><tr><td align="left"> </td><td align="left">frequency: low</td><td align="right">0.00047271</td><td align="right">0.02174179</td><td align="right">&#43;1.00</td><td align="right"> </td></tr><tr><td align="left"> </td><td align="left">context: unmatched</td><td align="right">0.00060125</td><td align="right">0.02452040</td><td align="right">&#43;1.00</td><td align="right">&#43;1.00</td></tr><tr><td align="left">Residual</td><td align="left"> </td><td align="right">1.01911794</td><td align="right">1.00951371</td><td align="right"> </td><td align="right"> </td></tr></table>
<p>For each grouping variable (subjects and items), there are two major components: the standard deviations ahd the correlations.</p><p>For this example, we&#39;ll just assume all the correlations and thus the covariances are 0 in order to make things simple. Then we only have to worry about the standard deviations.</p><p>Let&#39;s assume that the variability</p><ul><li>between items<ul><li>in the intercept is 1.3 times the residual variability</li><li>in age is 0.35 times the residual variability</li><li>in context is 0.75 times the residual variability</li></ul></li><li>between subjects<ul><li>in the intercept is 1.5 times the residual variability</li><li>in frequency is 0.5 times the residual variability</li><li>in context is 0.75 times the residual variability</li></ul></li></ul><p>Note these are always specified relative to the residual standard deviation. In other words, we think about how big the between-subject and between-item differences are relative to the between-observation differences.</p><p>We can now create the associated covariance matrices.<sup class="footnote-reference"><a id="citeref-cholesky" href="#footnote-cholesky">[cholesky]</a></sup></p><pre><code class="language-julia">re_item = create_re(1.3, 0.35, 0.75)</code></pre><pre class="documenter-example-output">3×3 LinearAlgebra.LowerTriangular{Float64, LinearAlgebra.Diagonal{Float64, Vector{Float64}}}:
 1.3   ⋅     ⋅ 
 0.0  0.35   ⋅ 
 0.0  0.0   0.75</pre><pre><code class="language-julia">re_subj = create_re(1.5, 0.5, 0.75)</code></pre><pre class="documenter-example-output">3×3 LinearAlgebra.LowerTriangular{Float64, LinearAlgebra.Diagonal{Float64, Vector{Float64}}}:
 1.5   ⋅    ⋅ 
 0.0  0.5   ⋅ 
 0.0  0.0  0.75</pre><p>We can check that we got these right by installing these parameter values into the model. Note that we have to specify them in the same order as in the output from <code>VarCorr</code>.</p><pre><code class="language-julia">update!(m0, re_item, re_subj)
VarCorr(m0)</code></pre><table><tr><th align="left"> </th><th align="left">Column</th><th align="right"> Variance</th><th align="right">Std.Dev</th><th align="right">Corr.</th><th align="right"> </th></tr><tr><td align="left">item</td><td align="left">&#40;Intercept&#41;</td><td align="right">1.645411</td><td align="right">1.282736</td><td align="right"> </td><td align="right"> </td></tr><tr><td align="left"> </td><td align="left">age: old</td><td align="right">0.119268</td><td align="right">0.345352</td><td align="right">&#43;0.00</td><td align="right"> </td></tr><tr><td align="left"> </td><td align="left">context: unmatched</td><td align="right">0.547659</td><td align="right">0.740040</td><td align="right">&#43;0.00</td><td align="right">&#43;0.00</td></tr><tr><td align="left">subj</td><td align="left">&#40;Intercept&#41;</td><td align="right">2.190636</td><td align="right">1.480080</td><td align="right"> </td><td align="right"> </td></tr><tr><td align="left"> </td><td align="left">frequency: low</td><td align="right">0.243404</td><td align="right">0.493360</td><td align="right">&#43;0.00</td><td align="right"> </td></tr><tr><td align="left"> </td><td align="left">context: unmatched</td><td align="right">0.547659</td><td align="right">0.740040</td><td align="right">&#43;0.00</td><td align="right">&#43;0.00</td></tr><tr><td align="left">Residual</td><td align="left"> </td><td align="right">0.973616</td><td align="right">0.986720</td><td align="right"> </td><td align="right"> </td></tr></table>
<p>Looks good. The values don&#39;t exactly match the values in our parameter vector because the residual standard deviation isn&#39;t exactly 1.0.</p><p>For the actual simulation, we&#39;ll need the compact form of these covariance matrices that MixedModels.jl stores uses internally. This compact form is the parameter vector θ and we can get it back out of the model where we just installed it:</p><pre><code class="language-julia">θ = m0.θ</code></pre><pre class="documenter-example-output">12-element Vector{Float64}:
 1.3
 0.0
 0.0
 0.35
 0.0
 0.75
 1.5
 0.0
 0.0
 0.5
 0.0
 0.75</pre><p>Alternatively, we could also create it directly from the covariance matrices we created:</p><pre><code class="language-julia">vcat( flatlowertri(re_item), flatlowertri(re_subj) )</code></pre><pre class="documenter-example-output">12-element Vector{Float64}:
 1.3
 0.0
 0.0
 0.35
 0.0
 0.75
 1.5
 0.0
 0.0
 0.5
 0.0
 0.75</pre><h2 id="Assemble-the-Fixed-Effects"><a class="docs-heading-anchor" href="#Assemble-the-Fixed-Effects">Assemble the Fixed Effects</a><a id="Assemble-the-Fixed-Effects-1"></a><a class="docs-heading-anchor-permalink" href="#Assemble-the-Fixed-Effects" title="Permalink"></a></h2><p>The last two components we need are the residual variance and the effect sizes for the fixed effects.</p><pre><code class="language-julia">σ = 5
β = [1.0, -1.0, 2.0, -1.5, 0.3, -1.3, 1.4, 0]</code></pre><pre class="documenter-example-output">8-element Vector{Float64}:
  1.0
 -1.0
  2.0
 -1.5
  0.3
 -1.3
  1.4
  0.0</pre><p>The entries in the β correspond to the coefficients in the model given by</p><pre><code class="language-julia">coefnames(m0)</code></pre><pre class="documenter-example-output">8-element Vector{String}:
 &quot;(Intercept)&quot;
 &quot;age: old&quot;
 &quot;frequency: low&quot;
 &quot;context: unmatched&quot;
 &quot;age: old &amp; frequency: low&quot;
 &quot;age: old &amp; context: unmatched&quot;
 &quot;frequency: low &amp; context: unmatched&quot;
 &quot;age: old &amp; frequency: low &amp; context: unmatched&quot;</pre><h2 id="Simulate"><a class="docs-heading-anchor" href="#Simulate">Simulate</a><a id="Simulate-1"></a><a class="docs-heading-anchor-permalink" href="#Simulate" title="Permalink"></a></h2><p>Now we&#39;re ready to actually simulate our data. We can use <code>parametricbootstrap</code> to do this: the parametric bootstrap actually works by simulating new data from an existing model and then looking at how the estimates fit to that new data look. In MixedModels.jl, you can specify different parameter values, such as the ones  we made up for our fake data.</p><pre><code class="language-julia"># typically we would use a lot more simulations
# but we want to be quick in this example
sim = parametricbootstrap(MersenneTwister(12321), 20, m0; β=β, σ=σ, θ=θ)</code></pre><pre class="documenter-example-output">MixedModels.MixedModelBootstrap{Float64}(NamedTuple{(:objective, :σ, :β, :se, :θ), Tuple{Float64, Float64, NamedTuple{(Symbol(&quot;(Intercept)&quot;), Symbol(&quot;age: old&quot;), Symbol(&quot;frequency: low&quot;), Symbol(&quot;context: unmatched&quot;), Symbol(&quot;age: old &amp; frequency: low&quot;), Symbol(&quot;age: old &amp; context: unmatched&quot;), Symbol(&quot;frequency: low &amp; context: unmatched&quot;), Symbol(&quot;age: old &amp; frequency: low &amp; context: unmatched&quot;)), NTuple{8, Float64}}, StaticArrays.SVector{8, Float64}, StaticArrays.SVector{12, Float64}}}[(objective = 40054.2932455852, σ = 4.9514185588262025, β = ((Intercept) = 0.0901136336663948, age: old = 1.953214006286154, frequency: low = 3.206751350615611, context: unmatched = -1.2578298713931138, age: old &amp; frequency: low = 0.4101342524007147, age: old &amp; context: unmatched = -0.38122950770806474, frequency: low &amp; context: unmatched = 1.5550036527634, age: old &amp; frequency: low &amp; context: unmatched = -0.11238528503304637), se = [1.2887081706220698, 1.0786758621470907, 0.7927000057528665, 0.737171957066391, 0.3621410853085706, 0.5986780053285369, 0.4345547727201076, 0.061892731985327534], θ = [1.3258947865133806, 0.012345385248749128, -0.15933351485158548, 0.3678879025311133, 0.14012045210521795, 0.747446545787824, 1.3506964048389667, -0.020412356855268453, -0.12655100998474922, 0.37357470867006093, -0.17319402463846229, 0.7297339776508761]), (objective = 40163.97386128881, σ = 5.019615323107125, β = ((Intercept) = 2.836279542129134, age: old = -0.820617917615051, frequency: low = 1.4385353792440398, context: unmatched = -1.5821059322582778, age: old &amp; frequency: low = 0.41317332294573855, age: old &amp; context: unmatched = -1.471634580893669, frequency: low &amp; context: unmatched = 1.4719459647508801, age: old &amp; frequency: low &amp; context: unmatched = -0.034684199700381835), se = [1.2998641099162433, 1.189630241980006, 0.6484428782326048, 0.6600945866442377, 0.38216694613451296, 0.5290272205043479, 0.399739943392766, 0.06274519153883906], θ = [0.9915231736563686, -0.030807357268481106, 0.02965759298680271, 0.332947262059132, -0.0653949870300823, 0.6997784535772749, 1.4780183686193438, 0.04087571967032551, 0.13069076855067352, 0.4099236987765904, 0.019999509252613634, 0.648512728336133]), (objective = 40222.395229945534, σ = 5.027128717085168, β = ((Intercept) = 1.9598845182353377, age: old = -2.4997432638569315, frequency: low = 2.8166905311802495, context: unmatched = -1.7074209491987498, age: old &amp; frequency: low = 0.010435097888361534, age: old &amp; context: unmatched = -1.7330392599309228, frequency: low &amp; context: unmatched = 1.3158755249866056, age: old &amp; frequency: low &amp; context: unmatched = 0.08957903379381657), se = [1.2736364166298655, 1.0899385120251117, 0.7683115756354766, 0.6561304555081672, 0.395118862481796, 0.48642733566026797, 0.44479700469207356, 0.06283910896356461], θ = [1.2204188114990633, -0.04190201676236505, 0.009761637853881261, 0.33650165112262403, -0.08658809297326782, 0.77858501596957, 1.3477914196542713, 0.0021585694557214076, 0.12796919685523772, 0.4281966154238259, -0.05669523393876939, 0.5904769890408259]), (objective = 40222.32131129571, σ = 4.9937696566549485, β = ((Intercept) = 1.2480438470478936, age: old = -0.8599760260789295, frequency: low = 2.3115175635765906, context: unmatched = -0.8567387073548145, age: old &amp; frequency: low = 0.3169699367235999, age: old &amp; context: unmatched = -2.0218245498448204, frequency: low &amp; context: unmatched = 0.9363662334757504, age: old &amp; frequency: low &amp; context: unmatched = 0.12165712191195369), se = [1.410004851069827, 1.21262363021797, 0.8904966531588321, 0.8626762790808677, 0.52471580670684, 0.7518838555545998, 0.4275249131908885, 0.06242212070818686], θ = [1.335660910497936, -0.045244106332241435, -0.012325365425733113, 0.34828539539173564, 0.058088635129918305, 0.7551968689845864, 1.5134989724974148, 0.1326760194652119, -0.07415349732069998, 0.5967367793908465, 0.10657100369669094, 0.9400421465490527]), (objective = 40289.83382834593, σ = 5.049447105259485, β = ((Intercept) = -0.110074038238345, age: old = -3.3461013281911733, frequency: low = 2.263774604038633, context: unmatched = -1.0383290367877491, age: old &amp; frequency: low = -0.11546458072635526, age: old &amp; context: unmatched = -1.0988994123435314, frequency: low &amp; context: unmatched = 1.7187264317924593, age: old &amp; frequency: low &amp; context: unmatched = -0.01873866253991663), se = [1.416030113104145, 1.2216680452006168, 0.8357216347415435, 0.6373045355917087, 0.43100137147987005, 0.4952293063362882, 0.40606514054678816, 0.06311808881574357], θ = [1.3129715058870082, -0.0380763505807254, -0.03635199593264951, 0.3374583873381764, -0.13149481195901452, 0.6973153665036166, 1.5091398229997905, 0.03973148628411957, 0.16743714781134844, 0.4753254950819809, 0.10818428576786118, 0.5820366109770541]), (objective = 40133.20222827087, σ = 4.966956494309972, β = ((Intercept) = 0.915974765292062, age: old = -1.599543550657864, frequency: low = 1.5578816432503602, context: unmatched = -0.7029900694732929, age: old &amp; frequency: low = 0.326941409852416, age: old &amp; context: unmatched = -1.5763594620766697, frequency: low &amp; context: unmatched = 1.6339817099170957, age: old &amp; frequency: low &amp; context: unmatched = -0.016458777756423952), se = [1.4295844403674336, 1.1681979014258566, 0.923490392892243, 0.7011395385298719, 0.4169042702047262, 0.5119127695273826, 0.4831115388939742, 0.06208695617887466], θ = [1.522439365871881, -0.004269080915745479, 0.13720331888465495, 0.34046328849545576, 0.13096141106302805, 0.8416438624378576, 1.465752437720743, -0.0677535445150498, 0.1696185241514967, 0.4615190595194637, 0.06050227251853277, 0.6214530084395591]), (objective = 40171.84753461876, σ = 5.006155667704661, β = ((Intercept) = -2.4524823735202204, age: old = -0.21242322657756862, frequency: low = 1.6342198900240756, context: unmatched = -0.03854201767814936, age: old &amp; frequency: low = 1.021541433550624, age: old &amp; context: unmatched = -1.2688723257938326, frequency: low &amp; context: unmatched = 1.5069741470507203, age: old &amp; frequency: low &amp; context: unmatched = 0.013038595178056653), se = [1.3423668413835366, 1.1813468161659328, 0.7311493478593447, 0.6645309884371923, 0.35806554162413307, 0.515662097338278, 0.42380409402613556, 0.06257694584630827], θ = [1.1974850426583405, 0.017276215395995505, 0.0035277761450755547, 0.36944409491228414, -0.09441456720710074, 0.7429081865130612, 1.4672412368150098, 0.003194698173173101, 0.0939330841229746, 0.36052657290789514, -0.0400228383535685, 0.6385381282746688]), (objective = 40006.35307624152, σ = 4.931460157222228, β = ((Intercept) = 1.8794165266312077, age: old = -0.8994093869399817, frequency: low = 1.7853147558689086, context: unmatched = -1.9359688988418007, age: old &amp; frequency: low = 0.395691978841128, age: old &amp; context: unmatched = -2.430082734421376, frequency: low &amp; context: unmatched = 1.7966564390325148, age: old &amp; frequency: low &amp; context: unmatched = 0.05802631931048689), se = [1.481775906734786, 1.2995184412154912, 0.8659275476502216, 0.6432095287082691, 0.4928679935459493, 0.5215645194209355, 0.381429994121, 0.06164325196527785], θ = [1.3366400229487099, 0.057498753058981555, 0.06397054172774713, 0.34026436412559163, 0.1609485509138309, 0.6603777972721067, 1.6467645263335149, -0.2569689604560575, -0.01467465184210793, 0.5174196463476208, -0.05068706463896089, 0.6621143309183222]), (objective = 40348.86232536586, σ = 5.053290868754975, β = ((Intercept) = 2.548565066404635, age: old = 0.21067405444207127, frequency: low = 3.5417371262974258, context: unmatched = -1.1442589276672486, age: old &amp; frequency: low = -0.1983128408528846, age: old &amp; context: unmatched = -1.032680159396349, frequency: low &amp; context: unmatched = 2.4985039934165316, age: old &amp; frequency: low &amp; context: unmatched = -1.7586556554478608e-5), se = [1.3217270178028737, 1.118466036160457, 0.8384886013304576, 0.8083447515806339, 0.45504626029994866, 0.6458005034882311, 0.49025800128247554, 0.06316613585943719], θ = [1.293340723108565, -0.053500637462309125, -0.1157292448993604, 0.34055883247213614, -0.08935796204150259, 0.8480062557074766, 1.376183712415868, -0.07583699879220722, -0.17565379608846798, 0.5029252924678808, 0.051283302329442615, 0.7833000663395708]), (objective = 40155.53121884324, σ = 4.9883790527226965, β = ((Intercept) = -0.14267530346153728, age: old = 1.201991503502235, frequency: low = 1.372334970758177, context: unmatched = -1.2326448556044562, age: old &amp; frequency: low = 0.7134340115646503, age: old &amp; context: unmatched = -1.8799675391733741, frequency: low &amp; context: unmatched = 1.2517204069421162, age: old &amp; frequency: low &amp; context: unmatched = -0.09498633757739192), se = [1.467443970309358, 1.3287794075100532, 0.7693946159583953, 0.7654489125384278, 0.4519192216431586, 0.6656598555890444, 0.38301058436340285, 0.06235473815903371], θ = [1.1718437820791907, 0.029890644865688685, 0.049937775489437244, 0.35465196706105623, 0.03051871920086819, 0.6750520677086955, 1.66392296189969, 0.08090942476506677, -0.1418574763576406, 0.5021571110210957, 0.1854500728096651, 0.8071596239156789]), (objective = 40133.59763106429, σ = 4.9958165168448465, β = ((Intercept) = -0.37187583547158, age: old = -2.090558913196476, frequency: low = 2.0905837065489665, context: unmatched = -0.525101276365661, age: old &amp; frequency: low = 0.1769955866793404, age: old &amp; context: unmatched = -1.3712724744793399, frequency: low &amp; context: unmatched = 1.6444720455961837, age: old &amp; frequency: low &amp; context: unmatched = -0.013681292492225277), se = [1.1470487744998128, 0.9178499973908354, 0.7915585195570966, 0.7263772482455365, 0.3915260100078639, 0.6054946352704219, 0.40607864936464827, 0.06244770646056058], θ = [1.2736126111666657, -0.0315768845285249, 0.051564550538826394, 0.32261930917588355, 0.05019200095078624, 0.7147625951257971, 1.1363916841358825, -0.07803383821604032, -0.16477353411981124, 0.4252054717225751, 0.07416766495703461, 0.7407291595202675]), (objective = 40496.37175136225, σ = 5.117208165400806, β = ((Intercept) = 2.466029890935151, age: old = -1.6966903104217441, frequency: low = 1.9945228475923893, context: unmatched = -1.0908889141238312, age: old &amp; frequency: low = -0.008327809337984321, age: old &amp; context: unmatched = -1.0682574171783563, frequency: low &amp; context: unmatched = 0.9868020390392216, age: old &amp; frequency: low &amp; context: unmatched = -0.01970068254128112), se = [1.4925674275969656, 1.2974158857951208, 0.8644272291708028, 0.6606926558631424, 0.4502942252845661, 0.49323414420737693, 0.44421436129645775, 0.06396510206751008], θ = [1.3464368670077687, 0.08056698881122115, -0.07004715037099724, 0.3781513749047791, 0.15179447921905165, 0.7499343148544966, 1.5780691562955165, 0.09083205824342808, 0.091072678443607, 0.4695605855235255, 0.03980383893946516, 0.5962317384488489]), (objective = 40300.56487351933, σ = 5.042438150054296, β = ((Intercept) = 1.3897776116925853, age: old = -1.0605924356775875, frequency: low = 0.9422379738900107, context: unmatched = -1.027478252005023, age: old &amp; frequency: low = 0.6237469751517719, age: old &amp; context: unmatched = -1.8345892256798508, frequency: low &amp; context: unmatched = 1.4120894517087799, age: old &amp; frequency: low &amp; context: unmatched = -0.020598949346291473), se = [1.3126258975248524, 1.0747457235008069, 0.9168989084076682, 0.7378013906807831, 0.5222980294558496, 0.6115352205517166, 0.4175504845286376, 0.0630304768756787], θ = [1.3747488617849177, -0.008073299155067312, 0.0682212370797909, 0.3209725027495397, 0.1781505092957415, 0.7068745555243445, 1.3264062966573626, -0.015489390944454985, 0.2350424512349767, 0.6091980206671315, 0.025050389761879583, 0.7254023638961965]), (objective = 40292.295077434384, σ = 5.029245257417437, β = ((Intercept) = -0.32583608083342475, age: old = -2.3126884984230203, frequency: low = 2.2414512183674575, context: unmatched = -0.8344797775117934, age: old &amp; frequency: low = 0.9055090665712556, age: old &amp; context: unmatched = -1.4168178439326287, frequency: low &amp; context: unmatched = 1.1283682275302003, age: old &amp; frequency: low &amp; context: unmatched = -0.08265547839290152), se = [1.3449769139509387, 1.0821870849032085, 0.9034722147262483, 0.766398750216685, 0.42240742234812456, 0.6271363095847298, 0.4449934526340046, 0.06286556571771797], θ = [1.4661961449685597, 0.034732215440857146, 0.03682796535077501, 0.36211150366748757, -0.10106511054824774, 0.7760430359856266, 1.334039555046908, -0.010180700326741359, 0.10403610917840285, 0.4578811097192101, 0.01041278483331496, 0.7776893258121482]), (objective = 40101.81420338245, σ = 4.966161709154984, β = ((Intercept) = 3.8495115174845203, age: old = -2.0262463553361663, frequency: low = 2.6094696387939726, context: unmatched = -1.634547692116163, age: old &amp; frequency: low = 0.4288414392468675, age: old &amp; context: unmatched = -1.6221505385358006, frequency: low &amp; context: unmatched = 1.28765652552325, age: old &amp; frequency: low &amp; context: unmatched = 0.08769695290777244), se = [1.3376706613323106, 1.1441266262704481, 0.822579624557558, 0.7818407177480905, 0.4430577586353882, 0.6770153425839858, 0.3959528891369662, 0.0620770213644373], θ = [1.2926080447818982, -0.04562809667885321, -0.065462305497103, 0.3326515760488182, 0.024890915842486833, 0.700818847588126, 1.4354306004141795, 0.06282854100574635, -0.07336936405878405, 0.501804828379047, -0.16267744765589887, 0.839815789897633]), (objective = 40383.95500652211, σ = 5.06283523051736, β = ((Intercept) = 1.8840080969011788, age: old = -3.193201548137056, frequency: low = 2.413695765300328, context: unmatched = -1.9481949660853184, age: old &amp; frequency: low = -0.07818433889051751, age: old &amp; context: unmatched = -0.676114080873439, frequency: low &amp; context: unmatched = 1.347524560182928, age: old &amp; frequency: low &amp; context: unmatched = 0.02731013124273741), se = [1.5442224992147862, 1.3046940450896014, 0.9545754175328947, 0.7567247814297074, 0.47834888101612894, 0.6515353469012295, 0.39005016796880776, 0.063285440381467], θ = [1.5066941468459747, 0.06844915329276503, 0.025622670008579866, 0.36829325939811364, -0.10675240462870984, 0.6710313521046889, 1.606226858284833, 0.002404226963809511, -0.04188893467035633, 0.5297722684072723, 0.3259160929643706, 0.7404166346742405]), (objective = 40273.82600376054, σ = 5.047538984550136, β = ((Intercept) = 3.116335850516152, age: old = -0.04183008025394492, frequency: low = 2.260239405502486, context: unmatched = -1.4488582173878213, age: old &amp; frequency: low = 0.37296249077031596, age: old &amp; context: unmatched = -1.2658127295163246, frequency: low &amp; context: unmatched = 1.861822105434039, age: old &amp; frequency: low &amp; context: unmatched = -0.04184076690720686), se = [1.250364092788886, 1.0906983568898254, 0.7579110359608597, 0.6669859890056605, 0.447930440603205, 0.5192611036841481, 0.42334276716615443, 0.0630942373068767], θ = [1.1376862372736745, -0.00943947152845694, 0.11652501166028513, 0.3471967955750276, -0.025444758244573817, 0.7321364072490901, 1.3420673591033936, 0.0886402673859264, -0.06717809390869059, 0.49049331091878356, 0.08851437965624426, 0.63618051373615]), (objective = 40204.35241044911, σ = 4.995783492236941, β = ((Intercept) = 0.9032569945389308, age: old = 0.16870796550788206, frequency: low = 0.7154059865258723, context: unmatched = -1.0855631347218073, age: old &amp; frequency: low = 0.11038942086758621, age: old &amp; context: unmatched = -1.7698270413615595, frequency: low &amp; context: unmatched = 1.4780763539783162, age: old &amp; frequency: low &amp; context: unmatched = -0.11271456002824831), se = [1.402125776880336, 1.1989341362009058, 0.8349638180206608, 0.8072176431135692, 0.41067133593168714, 0.6760824709904726, 0.44543515830870234, 0.06244729365296177], θ = [1.3522897929129563, -0.052537231776775856, -0.03838209597750275, 0.3630810299045907, -0.15016534264074527, 0.7742540509728616, 1.4934017707993663, -0.024540863226865314, 0.1281397408488552, 0.4428893250739832, 0.22136649892921156, 0.8129588762547956]), (objective = 40195.761547416005, σ = 5.015377667261567, β = ((Intercept) = 1.8089851510299306, age: old = 0.6680711455883992, frequency: low = 1.9589827306918868, context: unmatched = -1.0486181343472107, age: old &amp; frequency: low = 0.10281734345426702, age: old &amp; context: unmatched = -0.8417274361514687, frequency: low &amp; context: unmatched = 0.8548454970753506, age: old &amp; frequency: low &amp; context: unmatched = -0.04884905804509959), se = [1.161837548569983, 0.9072136948146495, 0.8452136336079092, 0.6939286930258621, 0.4330776895986649, 0.5573555403004369, 0.41811738454047964, 0.06269222084076959], θ = [1.33344174922201, 0.007225887266573281, -0.03222996763641672, 0.32012729775604803, 0.057467257151958634, 0.734278099907403, 1.1186058198907696, -0.014591479577637931, 0.1913571115946297, 0.4904313425462691, -0.026318450329120602, 0.6711399852439358]), (objective = 40437.87076316928, σ = 5.101447382283182, β = ((Intercept) = 0.009066643036074148, age: old = 0.363886625738736, frequency: low = 1.7989610685866222, context: unmatched = -2.4479421170018014, age: old &amp; frequency: low = 0.3553982836252865, age: old &amp; context: unmatched = -1.6809232945633232, frequency: low &amp; context: unmatched = 1.0084793264194938, age: old &amp; frequency: low &amp; context: unmatched = 0.0009755577083384549), se = [1.3276728953440577, 1.1458946684632698, 0.8160018401427876, 0.7793601453753364, 0.46499277123117533, 0.6501353312077759, 0.4345027697356547, 0.06376809227853979], θ = [1.2182478424737342, -0.0006493670631291755, 0.02580978393303782, 0.31927107378078934, 0.0319565329650863, 0.7524362616670173, 1.4003482340971607, -0.07047557766635494, 0.03398969825183142, 0.5197527584402332, -0.12348088555654331, 0.7918327213712423])], LinearAlgebra.LowerTriangular{Float64, Matrix{Float64}}[[1.3 0.0 0.0; 0.0 0.35 0.0; 0.0 0.0 0.75], [1.5 0.0 0.0; 0.0 0.5 0.0; 0.0 0.0 0.75]], [[1, 2, 3, 5, 6, 9], [1, 2, 3, 5, 6, 9]], [0.0, -Inf, -Inf, 0.0, -Inf, 0.0, 0.0, -Inf, -Inf, 0.0, -Inf, 0.0], (item = (&quot;(Intercept)&quot;, &quot;age: old&quot;, &quot;context: unmatched&quot;), subj = (&quot;(Intercept)&quot;, &quot;frequency: low&quot;, &quot;context: unmatched&quot;)))</pre><h2 id="See-your-power-and-profit!"><a class="docs-heading-anchor" href="#See-your-power-and-profit!">See your power and profit!</a><a id="See-your-power-and-profit!-1"></a><a class="docs-heading-anchor-permalink" href="#See-your-power-and-profit!" title="Permalink"></a></h2><p>Finally, we can turn this into a power table:</p><pre><code class="language-julia">ptbl = power_table(sim)</code></pre><pre class="documenter-example-output">8-element Vector{NamedTuple{(:coefname, :power), Tuple{String, Float64}}}:
 (coefname = &quot;(Intercept)&quot;, power = 0.15)
 (coefname = &quot;age: old&quot;, power = 0.25)
 (coefname = &quot;frequency: low&quot;, power = 0.8)
 (coefname = &quot;context: unmatched&quot;, power = 0.35)
 (coefname = &quot;age: old &amp; frequency: low&quot;, power = 0.1)
 (coefname = &quot;age: old &amp; context: unmatched&quot;, power = 0.8)
 (coefname = &quot;frequency: low &amp; context: unmatched&quot;, power = 1.0)
 (coefname = &quot;age: old &amp; frequency: low &amp; context: unmatched&quot;, power = 0.0)</pre><p>For nicely displaying it, we can again use <code>pretty_table</code>:</p><pre><code class="language-julia">pretty_table(ptbl)</code></pre><pre class="documenter-example-output">┌────────────────────────────────────────────────┬─────────┐
│                                       coefname │   power │
│                                         String │ Float64 │
├────────────────────────────────────────────────┼─────────┤
│                                    (Intercept) │    0.15 │
│                                       age: old │    0.25 │
│                                 frequency: low │     0.8 │
│                             context: unmatched │    0.35 │
│                      age: old &amp; frequency: low │     0.1 │
│                  age: old &amp; context: unmatched │     0.8 │
│            frequency: low &amp; context: unmatched │     1.0 │
│ age: old &amp; frequency: low &amp; context: unmatched │     0.0 │
└────────────────────────────────────────────────┴─────────┘</pre><p>We can of course convert the row table into a DataFrame:</p><pre><code class="language-julia">DataFrame(ptbl)</code></pre><table class="data-frame"><thead><tr><th></th><th>coefname</th><th>power</th></tr><tr><th></th><th>String</th><th>Float64</th></tr></thead><tbody><p>8 rows × 2 columns</p><tr><th>1</th><td>(Intercept)</td><td>0.15</td></tr><tr><th>2</th><td>age: old</td><td>0.25</td></tr><tr><th>3</th><td>frequency: low</td><td>0.8</td></tr><tr><th>4</th><td>context: unmatched</td><td>0.35</td></tr><tr><th>5</th><td>age: old &amp; frequency: low</td><td>0.1</td></tr><tr><th>6</th><td>age: old &amp; context: unmatched</td><td>0.8</td></tr><tr><th>7</th><td>frequency: low &amp; context: unmatched</td><td>1.0</td></tr><tr><th>8</th><td>age: old &amp; frequency: low &amp; context: unmatched</td><td>0.0</td></tr></tbody></table><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-cholesky"><a class="tag is-link" href="#citeref-cholesky">cholesky</a>Technically, we&#39;re creating the lower Cholesky factor of these matrices, which is a bit like the matrix square root. In other words, we&#39;re creating the matrix form of standard deviations instead of the matrix form of the variances.]</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« MixedModelsSim.jl</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 24 March 2021 20:21">Wednesday 24 March 2021</span>. Using Julia version 1.6.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
