<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Beginner Friendly Tutorial · MixedModelsSim.jl</title><meta name="title" content="Beginner Friendly Tutorial · MixedModelsSim.jl"/><meta property="og:title" content="Beginner Friendly Tutorial · MixedModelsSim.jl"/><meta property="twitter:title" content="Beginner Friendly Tutorial · MixedModelsSim.jl"/><meta name="description" content="Documentation for MixedModelsSim.jl."/><meta property="og:description" content="Documentation for MixedModelsSim.jl."/><meta property="twitter:description" content="Documentation for MixedModelsSim.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">MixedModelsSim.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">MixedModelsSim.jl</a></li><li><a class="tocitem" href="../simulation/">Rapid Start</a></li><li class="is-active"><a class="tocitem" href>Beginner Friendly Tutorial</a><ul class="internal"><li><a class="tocitem" href="#Setup"><span>Setup</span></a></li><li><a class="tocitem" href="#Use-existing-data-to-simulate-new-data"><span>Use existing data to simulate new data</span></a></li><li><a class="tocitem" href="#Adapt-parameters-in-a-given-linear-mixed-model-to-analyze-power-without-generating-additional-data"><span>Adapt parameters in a given linear mixed model to analyze power without generating additional data</span></a></li><li><a class="tocitem" href="#Create-and-analyze-a-(simple)-balanced-fully-crossed-dataset-from-scratch"><span>Create and analyze a (simple) balanced fully crossed dataset from scratch</span></a></li><li><a class="tocitem" href="#A-simple-example-from-scratch"><span>A simple example from scratch</span></a></li><li><a class="tocitem" href="#Compute-power-curves-for-a-more-complex-dataset"><span>Compute power curves for a more complex dataset</span></a></li><li><a class="tocitem" href="#Loop-over-subject-and-item-sizes"><span>Loop over subject and item sizes</span></a></li><li><a class="tocitem" href="#Acknowledgements"><span>Acknowledgements</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Beginner Friendly Tutorial</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Beginner Friendly Tutorial</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/RePsychLing/MixedModelsSim.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/RePsychLing/MixedModelsSim.jl/blob/main/docs/src/simulation_tutorial.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Power-Analysis-and-Simulation-Tutorial"><a class="docs-heading-anchor" href="#Power-Analysis-and-Simulation-Tutorial">Power Analysis and Simulation Tutorial</a><a id="Power-Analysis-and-Simulation-Tutorial-1"></a><a class="docs-heading-anchor-permalink" href="#Power-Analysis-and-Simulation-Tutorial" title="Permalink"></a></h1><p><em>contributed by Lisa Schwetlick and Daniel Backhaus</em></p><p>This tutorial demonstrates how to conduct power analyses and data simulation using Julia and the MixedModelsSim package.</p><p>Power analysis is an important tool for planning an experimental design. Here we show how to:</p><ol><li>Use existing data as a basis for power calculations by simulating new data.</li><li>Adapt parameters in a given linear mixed model to analyze power without changing the existing data set.</li><li>Create a (simple) balanced fully crossed dataset from scratch and analyze power.</li><li>Recreate a more complex dataset from scratch and analyze power for specific model parameter but various sample sizes.</li></ol><h2 id="Setup"><a class="docs-heading-anchor" href="#Setup">Setup</a><a id="Setup-1"></a><a class="docs-heading-anchor-permalink" href="#Setup" title="Permalink"></a></h2><h3 id="Load-the-packages-we&#39;ll-be-using-in-Julia"><a class="docs-heading-anchor" href="#Load-the-packages-we&#39;ll-be-using-in-Julia">Load the packages we&#39;ll be using in Julia</a><a id="Load-the-packages-we&#39;ll-be-using-in-Julia-1"></a><a class="docs-heading-anchor-permalink" href="#Load-the-packages-we&#39;ll-be-using-in-Julia" title="Permalink"></a></h3><p>First, here are the packages needed in this example.</p><pre><code class="language-julia hljs">using MixedModels        # run mixed models
using MixedModelsSim     # simulation utilities
using DataFrames, Tables # work with dataframes
using StableRNGs         # random number generator
using Statistics         # basic statistical functions
using DataFrameMacros    # dplyr-like operations
using CairoMakie         # plotting package
CairoMakie.activate!(type=&quot;svg&quot;) # use vector graphics
using MixedModelsMakie   # some extra plotting function for MixedModels
using ProgressMeter      # show progress in loops</code></pre><h3 id="Define-number-of-iterations"><a class="docs-heading-anchor" href="#Define-number-of-iterations">Define number of iterations</a><a id="Define-number-of-iterations-1"></a><a class="docs-heading-anchor-permalink" href="#Define-number-of-iterations" title="Permalink"></a></h3><p>Here we define how many model simulations we want to do. A large number will give more reliable results, but will take longer to compute. It is useful to set it to a low number for testing, and increase it for your final analysis.</p><pre><code class="language-julia hljs"># for real power analysis, set this much higher
nsims = 100</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">100</code></pre><h2 id="Use-existing-data-to-simulate-new-data"><a class="docs-heading-anchor" href="#Use-existing-data-to-simulate-new-data">Use existing data to simulate new data</a><a id="Use-existing-data-to-simulate-new-data-1"></a><a class="docs-heading-anchor-permalink" href="#Use-existing-data-to-simulate-new-data" title="Permalink"></a></h2><h3 id="Build-a-linear-mixed-model-from-existing-data"><a class="docs-heading-anchor" href="#Build-a-linear-mixed-model-from-existing-data">Build a linear mixed model from existing data</a><a id="Build-a-linear-mixed-model-from-existing-data-1"></a><a class="docs-heading-anchor-permalink" href="#Build-a-linear-mixed-model-from-existing-data" title="Permalink"></a></h3><p>For the first example we are going to simulate data bootstrapped  from an existing data set, namely Experiment 2 from</p><div class="admonition is-category-dataset" id="Dataset-5c5e90f72d85570a"><header class="admonition-header">Dataset<a class="admonition-anchor" href="#Dataset-5c5e90f72d85570a" title="Permalink"></a></header><div class="admonition-body"><p>Kronmüller, E., &amp; Barr, D. J. (2007). Perspective-free pragmatics: Broken precedents and the recovery-from-preemption hypothesis. Journal of Memory and Language, 56(3), 436-455.</p></div></div><p>This was an experiment about how in a conversation the change of a speaker or the change of precedents (which are patterns of word usage to describe an object, e.g. one can refer to the same object &quot;white shoes&quot;, &quot;runners&quot;, &quot;sneakers&quot;) affects the understanding.</p><p>In experiment, objects were presented on a screen while participants listened to instructions to move the objects around. Participants&#39; eye movements were tracked. The dependent variable is response time, defined as the latency between the onset of the test description and the moment at which the target was selected. The independent variables are speaker (old vs. new), precedents (maintain vs. break) and cognitive load (yes vs. no; from a secondary memory task).</p><p>We first load the data and define some characteristics like the contrasts and the underlying model. This dataset is one of the example datasets provided by MixedModels.jl.</p><p>Load existing data:</p><pre><code class="language-julia hljs">kb07 = MixedModels.dataset(:kb07);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Arrow.Table with 1789 rows, 7 columns, and schema:
 :subj      String
 :item      String
 :spkr      String
 :prec      String
 :load      String
 :rt_trunc  Int16
 :rt_raw    Int16</code></pre><p>Set contrasts:</p><pre><code class="language-julia hljs">contrasts = Dict(:spkr =&gt; HelmertCoding(),
                 # set the reference level such that all the coefs
                 # have the same sign, which makes the plotting nicer
                 :prec =&gt; HelmertCoding(base=&quot;maintain&quot;),
                 :load =&gt; HelmertCoding(),
                 # pseudo-contrast for grouping variables
                 :item =&gt; Grouping(),
                 :subj =&gt; Grouping());</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Dict{Symbol, StatsModels.AbstractContrasts} with 5 entries:
  :item =&gt; Grouping()
  :spkr =&gt; HelmertCoding(nothing, nothing)
  :load =&gt; HelmertCoding(nothing, nothing)
  :prec =&gt; HelmertCoding(&quot;maintain&quot;, nothing)
  :subj =&gt; Grouping()</code></pre><p>The chosen linear mixed model (LMM) for this dataset is defined by the following model formula:</p><pre><code class="language-julia hljs">kb07_f = @formula(rt_trunc ~ 1 + spkr + prec + load + (1|subj) + (1 + prec|item));</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">FormulaTerm
Response:
  rt_trunc(unknown)
Predictors:
  1
  spkr(unknown)
  prec(unknown)
  load(unknown)
  (subj)-&gt;1 | subj
  (prec,item)-&gt;(1 + prec) | item</code></pre><p>Fit the model:</p><pre><code class="language-julia hljs">kb07_m = fit(MixedModel, kb07_f, kb07; contrasts=contrasts)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Linear mixed model fit by maximum likelihood
 rt_trunc ~ 1 + spkr + prec + load + (1 | subj) + (1 + prec | item)
    logLik   -2 logLik      AIC         AICc        BIC     
 -14331.9251  28663.8501  28681.8501  28681.9513  28731.2548

Variance components:
            Column    Variance  Std.Dev.  Corr.
item     (Intercept)  133015.316 364.713
         prec: break   63767.106 252.521 +0.70
subj     (Intercept)   88819.341 298.026
Residual              462443.369 680.032
 Number of obs: 1789; levels of grouping factors: 32, 56

  Fixed-effects parameters:
───────────────────────────────────────────────────
                 Coef.  Std. Error      z  Pr(&gt;|z|)
───────────────────────────────────────────────────
(Intercept)  2181.85       77.4681  28.16    &lt;1e-99
spkr: old      67.879      16.0785   4.22    &lt;1e-04
prec: break   333.791      47.4472   7.03    &lt;1e-11
load: yes      78.5904     16.0785   4.89    &lt;1e-05
───────────────────────────────────────────────────</code></pre><h3 id="Simulate-from-existing-data-with-same-model-parameters"><a class="docs-heading-anchor" href="#Simulate-from-existing-data-with-same-model-parameters">Simulate from existing data with same model parameters</a><a id="Simulate-from-existing-data-with-same-model-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Simulate-from-existing-data-with-same-model-parameters" title="Permalink"></a></h3><p>We will first look at the power of the dataset with the same parameters as in the original data set. This means that each dataset will have the exact number of observations as the original data. Here, we use the model <code>kb07_m</code> we fitted above to our dataset <code>kb07</code>.</p><p>You can use the <code>parametricbootstrap()</code> function to run <code>nsims</code> iterations of data sampled using the parameters from <code>kb07_m</code>.</p><div class="admonition is-info" id="Info-b4a6ae75090cb096"><header class="admonition-header">Info<a class="admonition-anchor" href="#Info-b4a6ae75090cb096" title="Permalink"></a></header><div class="admonition-body"><p>The parametric bootstrap is actually a simulation procedure. Each bootstrap iteration</p><ol><li>simulates new data based on an existing model</li><li>then fits a model to that data to obtain new estimates.</li></ol></div></div><p>Set up a random seed to make the simulation reproducible. You can use your favourite number.</p><p>To use multithreading, you need to set the number of worker threads you want to use. In VS Code, open the settings (gear icon in the lower left corner) and search for &quot;thread&quot;. Set <code>julia.NumThreads</code> to the number of threads you want to use (at least 1 less than the total number of processor cores available, so that you can continue watching YouTube while the simulation runs).</p><p>Set random seed for reproducibility:</p><pre><code class="language-julia hljs">rng = StableRNG(42);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">StableRNGs.LehmerRNG(state=0x00000000000000000000000000000055)</code></pre><p>Run nsims iterations:</p><pre><code class="language-julia hljs">kb07_sim = parametricbootstrap(rng, nsims, kb07_m);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">MixedModelBootstrap with 100 samples
      parameter  min        q25       median    mean      q75       max
    ┌───────────────────────────────────────────────────────────────────────
 1  │ β1         1972.91    2120.95   2174.44   2177.43   2223.65   2440.67
 2  │ β2         29.0592    56.4117   69.0202   67.744    77.2937   120.402
 3  │ β3         219.728    296.828   335.884   331.123   366.562   428.224
 4  │ β4         52.5324    67.1774   79.775    79.5486   88.9861   127.721
 5  │ σ          642.221    670.692   679.78    679.179   689.241   707.028
 6  │ σ1         238.633    325.213   353.38    353.592   385.467   455.208
 7  │ σ2         159.903    231.305   252.172   250.285   270.406   325.657
 8  │ ρ1         0.210784   0.647394  0.726712  0.701725  0.776082  0.915599
 9  │ σ3         212.885    271.694   292.296   294.669   320.797   369.074
 10 │ θ1         0.350737   0.479787  0.52304   0.520726  0.563495  0.692606
 11 │ θ2         0.0743033  0.221855  0.262451  0.260231  0.296548  0.378762
 12 │ θ3         0.147016   0.222004  0.253308  0.25476   0.283882  0.37614
 13 │ θ4         0.319387   0.403039  0.431075  0.433985  0.472286  0.551702
</code></pre><p>The returned value <code>kb07_sim</code> contains the results of the bootstrapping procedure, which we can convert to a dataframe</p><pre><code class="language-julia hljs">df = DataFrame(kb07_sim.allpars);
first(df, 12)</code></pre><div><div style = "float: left;"><span>12×5 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">iter</th><th style = "text-align: left;">type</th><th style = "text-align: left;">group</th><th style = "text-align: left;">names</th><th style = "text-align: left;">value</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "String" style = "text-align: left;">String</th><th title = "Union{Missing, String}" style = "text-align: left;">String?</th><th title = "Union{Missing, String}" style = "text-align: left;">String?</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: right;">1</td><td style = "text-align: left;">β</td><td style = "font-style: italic; text-align: left;">missing</td><td style = "text-align: left;">(Intercept)</td><td style = "text-align: right;">2284.56</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: right;">1</td><td style = "text-align: left;">β</td><td style = "font-style: italic; text-align: left;">missing</td><td style = "text-align: left;">spkr: old</td><td style = "text-align: right;">29.0592</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: right;">1</td><td style = "text-align: left;">β</td><td style = "font-style: italic; text-align: left;">missing</td><td style = "text-align: left;">prec: break</td><td style = "text-align: right;">379.985</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: right;">1</td><td style = "text-align: left;">β</td><td style = "font-style: italic; text-align: left;">missing</td><td style = "text-align: left;">load: yes</td><td style = "text-align: right;">53.2007</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: right;">1</td><td style = "text-align: left;">σ</td><td style = "text-align: left;">item</td><td style = "text-align: left;">(Intercept)</td><td style = "text-align: right;">262.515</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: right;">1</td><td style = "text-align: left;">σ</td><td style = "text-align: left;">item</td><td style = "text-align: left;">prec: break</td><td style = "text-align: right;">258.767</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: right;">1</td><td style = "text-align: left;">ρ</td><td style = "text-align: left;">item</td><td style = "text-align: left;">(Intercept), prec: break</td><td style = "text-align: right;">0.210784</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: right;">1</td><td style = "text-align: left;">σ</td><td style = "text-align: left;">subj</td><td style = "text-align: left;">(Intercept)</td><td style = "text-align: right;">291.504</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: right;">1</td><td style = "text-align: left;">σ</td><td style = "text-align: left;">residual</td><td style = "font-style: italic; text-align: left;">missing</td><td style = "text-align: right;">672.498</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">10</td><td style = "text-align: right;">2</td><td style = "text-align: left;">β</td><td style = "font-style: italic; text-align: left;">missing</td><td style = "text-align: left;">(Intercept)</td><td style = "text-align: right;">2123.42</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">11</td><td style = "text-align: right;">2</td><td style = "text-align: left;">β</td><td style = "font-style: italic; text-align: left;">missing</td><td style = "text-align: left;">spkr: old</td><td style = "text-align: right;">64.8504</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">12</td><td style = "text-align: right;">2</td><td style = "text-align: left;">β</td><td style = "font-style: italic; text-align: left;">missing</td><td style = "text-align: left;">prec: break</td><td style = "text-align: right;">289.896</td></tr></tbody></table></div><p>The dataframe <code>df</code> has 4500 rows: 9 parameters, each from 500 iterations.</p><pre><code class="language-julia hljs">nrow(df)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">900</code></pre><p>We can now plot some bootstrapped parameters:</p><pre><code class="language-julia hljs">fig = Figure()

σres = @subset(df, :type == &quot;σ&quot; &amp;&amp; :group == &quot;residual&quot;)
ax = Axis(fig[1,1:2]; xlabel = &quot;residual standard deviation&quot;, ylabel = &quot;Density&quot;)
density!(ax, σres.value)

βInt = @subset(df, :type == &quot;β&quot; &amp;&amp; :names == &quot;(Intercept)&quot;)
ax = Axis(fig[1,3]; xlabel = &quot;fixed effect for intercept&quot;)
density!(ax, βInt.value)

βSpeaker = @subset(df, :type == &quot;β&quot; &amp;&amp; :names == &quot;spkr: old&quot;)
ax = Axis(fig[2,1]; xlabel = &quot;fixed effect for spkr: old&quot;, ylabel = &quot;Density&quot;)
density!(ax, βSpeaker.value)

βPrecedents = @subset(df, :type == &quot;β&quot; &amp;&amp; :names == &quot;prec: break&quot;)
ax = Axis(fig[2,2]; xlabel = &quot;fixed effect for prec: break&quot;)
density!(ax, βPrecedents.value)

βLoad = @subset(df, :type == &quot;β&quot; &amp;&amp; :names == &quot;load: yes&quot;)
ax = Axis(fig[2,3]; xlabel = &quot;fixed effect for load: yes&quot;)
density!(ax, βLoad.value)

Label(fig[0,:]; text = &quot;Parametric bootstrap replicates by parameter&quot;, fontsize=25)

fig</code></pre><img src="ba778481.svg" alt="Example block output"/><p>For the fixed effects, we can do this more succinctly via the ridgeplot functionality in MixedModelsMakie, even optionally omitting the intercept (which we often don&#39;t care about).</p><pre><code class="language-julia hljs">ridgeplot(kb07_sim; show_intercept=false)</code></pre><img src="a435bd9a.svg" alt="Example block output"/><p>Next, we extract the p-values of the fixed-effects parameters into a dataframe</p><pre><code class="language-julia hljs">kb07_sim_df = DataFrame(kb07_sim.coefpvalues);
first(kb07_sim_df, 8)</code></pre><div><div style = "float: left;"><span>8×6 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">iter</th><th style = "text-align: left;">coefname</th><th style = "text-align: left;">β</th><th style = "text-align: left;">se</th><th style = "text-align: left;">z</th><th style = "text-align: left;">p</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Symbol" style = "text-align: left;">Symbol</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: right;">1</td><td style = "text-align: left;">(Intercept)</td><td style = "text-align: right;">2284.56</td><td style = "text-align: right;">62.6402</td><td style = "text-align: right;">36.4711</td><td style = "text-align: right;">3.18535e-291</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: right;">1</td><td style = "text-align: left;">spkr: old</td><td style = "text-align: right;">29.0592</td><td style = "text-align: right;">15.9004</td><td style = "text-align: right;">1.82757</td><td style = "text-align: right;">0.0676139</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: right;">1</td><td style = "text-align: left;">prec: break</td><td style = "text-align: right;">379.985</td><td style = "text-align: right;">48.4287</td><td style = "text-align: right;">7.84627</td><td style = "text-align: right;">4.28608e-15</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: right;">1</td><td style = "text-align: left;">load: yes</td><td style = "text-align: right;">53.2007</td><td style = "text-align: right;">15.9004</td><td style = "text-align: right;">3.34587</td><td style = "text-align: right;">0.000820243</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: right;">2</td><td style = "text-align: left;">(Intercept)</td><td style = "text-align: right;">2123.42</td><td style = "text-align: right;">86.3469</td><td style = "text-align: right;">24.5917</td><td style = "text-align: right;">1.54789e-133</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: right;">2</td><td style = "text-align: left;">spkr: old</td><td style = "text-align: right;">64.8504</td><td style = "text-align: right;">16.2805</td><td style = "text-align: right;">3.98333</td><td style = "text-align: right;">6.79569e-5</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: right;">2</td><td style = "text-align: left;">prec: break</td><td style = "text-align: right;">289.896</td><td style = "text-align: right;">56.5227</td><td style = "text-align: right;">5.12884</td><td style = "text-align: right;">2.91533e-7</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: right;">2</td><td style = "text-align: left;">load: yes</td><td style = "text-align: right;">83.4592</td><td style = "text-align: right;">16.2804</td><td style = "text-align: right;">5.12635</td><td style = "text-align: right;">2.95416e-7</td></tr></tbody></table></div><p>Now that we have a bootstrapped data, we can start our power calculation.</p><h3 id="Power-calculation"><a class="docs-heading-anchor" href="#Power-calculation">Power calculation</a><a id="Power-calculation-1"></a><a class="docs-heading-anchor-permalink" href="#Power-calculation" title="Permalink"></a></h3><p>The function <code>power_table()</code> from <code>MixedModelsSim</code> takes the output of <code>parametricbootstrap()</code> and calculates the proportion of simulations where the p-value is less than alpha for each coefficient. You can set the <code>alpha</code> argument to change the default value of 0.05 (<a href="https://doi.org/10.1038/s41562-018-0311-x">justify your alpha</a>).</p><pre><code class="language-julia hljs">ptbl = power_table(kb07_sim, 0.05)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">4-element Vector{@NamedTuple{coefname::String, power::Float64}}:
 (coefname = &quot;prec: break&quot;, power = 1.0)
 (coefname = &quot;(Intercept)&quot;, power = 1.0)
 (coefname = &quot;spkr: old&quot;, power = 0.99)
 (coefname = &quot;load: yes&quot;, power = 1.0)</code></pre><p>An estimated power of 1 means that in every iteration the specific parameter we are looking at was below our alpha. An estimated power of 0.5 means that in half of our iterations the specific parameter we are looking at was below our alpha. An estimated power of 0 means that for none of our iterations the specific parameter we are looking at was below our alpha.</p><p>You can also do it manually:</p><pre><code class="language-julia hljs">prec_p = kb07_sim_df[kb07_sim_df.coefname .== Symbol(&quot;prec: break&quot;),:p]
mean(prec_p .&lt; 0.05)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.0</code></pre><p>For a nicer display, you can use <code>pretty_table</code>:</p><pre><code class="language-julia hljs">pretty_table(ptbl)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">┌─────────────┬─────────┐
│<span class="sgr1">    coefname </span>│<span class="sgr1">   power </span>│
│<span class="sgr90">      String </span>│<span class="sgr90"> Float64 </span>│
├─────────────┼─────────┤
│ prec: break │     1.0 │
│ (Intercept) │     1.0 │
│   spkr: old │    0.99 │
│   load: yes │     1.0 │
└─────────────┴─────────┘</code></pre><div class="admonition is-warning" id="Warning-5ea864786ea84b6e"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-5ea864786ea84b6e" title="Permalink"></a></header><div class="admonition-body"><p>The simulation so far should not be interpreted as the power of the original K&amp;B experiment. <a href="https://doi.org/10.1198/000313001300339897">Observed power calculations are generally problematic.</a> Instead, the example so far should serve to show how power can be computed using a simulation procedure.</p></div></div><p>In the next section, we show how to use previously observed data – such as pilot data – as the basis for a simulation study with a different effect size.</p><h2 id="Adapt-parameters-in-a-given-linear-mixed-model-to-analyze-power-without-generating-additional-data"><a class="docs-heading-anchor" href="#Adapt-parameters-in-a-given-linear-mixed-model-to-analyze-power-without-generating-additional-data">Adapt parameters in a given linear mixed model to analyze power without generating additional data</a><a id="Adapt-parameters-in-a-given-linear-mixed-model-to-analyze-power-without-generating-additional-data-1"></a><a class="docs-heading-anchor-permalink" href="#Adapt-parameters-in-a-given-linear-mixed-model-to-analyze-power-without-generating-additional-data" title="Permalink"></a></h2><p>Let&#39;s say we want to check our power to detect effects of spkr, prec, and load that are only half the size as in our pilot data. We can set a new vector of beta values (fixed effects) with the <code>β</code> argument to <code>parametricbootstrap()</code>.</p><p>Specify β:</p><pre><code class="language-julia hljs">new_beta = kb07_m.β
new_beta[2:4] = kb07_m.β[2:4] / 2</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3-element Vector{Float64}:
  33.93951071863982
 166.89531070993684
  39.2952206956523</code></pre><p>Run simulations:</p><pre><code class="language-julia hljs">kb07_sim_half = parametricbootstrap(StableRNG(42), nsims, kb07_m; β = new_beta);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">MixedModelBootstrap with 100 samples
      parameter  min        q25       median    mean      q75       max
    ┌───────────────────────────────────────────────────────────────────────
 1  │ β1         1972.91    2120.95   2174.44   2177.43   2223.65   2440.67
 2  │ β2         -4.88035   22.4722   35.0807   33.8044   43.3542   86.4629
 3  │ β3         52.8324    129.933   168.989   164.228   199.667   261.328
 4  │ β4         13.2372    27.8822   40.4798   40.2533   49.6909   88.4257
 5  │ σ          642.221    670.692   679.78    679.179   689.241   707.028
 6  │ σ1         238.633    325.213   353.38    353.592   385.467   455.208
 7  │ σ2         159.903    231.305   252.172   250.285   270.406   325.657
 8  │ ρ1         0.210784   0.647394  0.726714  0.701725  0.776082  0.915599
 9  │ σ3         212.885    271.694   292.297   294.669   320.797   369.074
 10 │ θ1         0.350737   0.479788  0.52304   0.520726  0.563495  0.692606
 11 │ θ2         0.0743039  0.221857  0.262451  0.260231  0.296548  0.378762
 12 │ θ3         0.147016   0.222004  0.253308  0.25476   0.283884  0.37614
 13 │ θ4         0.319387   0.403039  0.431075  0.433985  0.472286  0.551702
</code></pre><h3 id="Power-calculation-2"><a class="docs-heading-anchor" href="#Power-calculation-2">Power calculation</a><a class="docs-heading-anchor-permalink" href="#Power-calculation-2" title="Permalink"></a></h3><pre><code class="language-julia hljs">power_table(kb07_sim_half)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">4-element Vector{@NamedTuple{coefname::String, power::Float64}}:
 (coefname = &quot;prec: break&quot;, power = 0.93)
 (coefname = &quot;(Intercept)&quot;, power = 1.0)
 (coefname = &quot;spkr: old&quot;, power = 0.54)
 (coefname = &quot;load: yes&quot;, power = 0.73)</code></pre><h2 id="Create-and-analyze-a-(simple)-balanced-fully-crossed-dataset-from-scratch"><a class="docs-heading-anchor" href="#Create-and-analyze-a-(simple)-balanced-fully-crossed-dataset-from-scratch">Create and analyze a (simple) balanced fully crossed dataset from scratch</a><a id="Create-and-analyze-a-(simple)-balanced-fully-crossed-dataset-from-scratch-1"></a><a class="docs-heading-anchor-permalink" href="#Create-and-analyze-a-(simple)-balanced-fully-crossed-dataset-from-scratch" title="Permalink"></a></h2><p>In some situations, instead of using an existing dataset it may be useful to simulate the data from scratch. This could be the case when pilot data or data from a previous study are not available. Note that we still have to assume (or perhaps guess) a particular effect size, which can be derived from previous work (whether experimental or practical). In the worst case, we can start from the smallest effect size that we would find interesting or meaningful.</p><p>In order to simulate data from scratch, we have to:</p><ol><li>specify the effect sizes manually</li><li>manually create an experimental design, according to which data can be simulated</li></ol><p>If we simulate data from scratch, we can manipulate the arguments <code>β</code>, <code>σ</code> and <code>θ</code> (in addition to the number of subjects and items) Lets have a closer look at them, define their meaning and we will see where the corresponding values in the model output are.</p><h3 id="Fixed-Effects-(βs)"><a class="docs-heading-anchor" href="#Fixed-Effects-(βs)">Fixed Effects (βs)</a><a id="Fixed-Effects-(βs)-1"></a><a class="docs-heading-anchor-permalink" href="#Fixed-Effects-(βs)" title="Permalink"></a></h3><p><code>β</code> are our effect sizes.</p><p>If we look again on our LMM summary from the <code>kb07</code>-dataset <code>kb07_m</code> we see our four <code>β</code> under fixed-effects parameters in the <code>Coef.</code>-column.</p><pre><code class="language-julia hljs">kb07_m</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Linear mixed model fit by maximum likelihood
 rt_trunc ~ 1 + spkr + prec + load + (1 | subj) + (1 + prec | item)
    logLik   -2 logLik      AIC         AICc        BIC     
 -14331.9251  28663.8501  28681.8501  28681.9513  28731.2548

Variance components:
            Column    Variance  Std.Dev.  Corr.
item     (Intercept)  133015.316 364.713
         prec: break   63767.106 252.521 +0.70
subj     (Intercept)   88819.341 298.026
Residual              462443.369 680.032
 Number of obs: 1789; levels of grouping factors: 32, 56

  Fixed-effects parameters:
───────────────────────────────────────────────────
                 Coef.  Std. Error      z  Pr(&gt;|z|)
───────────────────────────────────────────────────
(Intercept)  2181.85       77.4681  28.16    &lt;1e-99
spkr: old      67.879      16.0785   4.22    &lt;1e-04
prec: break   333.791      47.4472   7.03    &lt;1e-11
load: yes      78.5904     16.0785   4.89    &lt;1e-05
───────────────────────────────────────────────────</code></pre><pre><code class="language-julia hljs">kb07_m.β</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">4-element Vector{Float64}:
 2181.8526389658705
   67.87902143727965
  333.7906214198737
   78.5904413913046</code></pre><p>(These can also be accessed with the appropriately named <code>coef</code> function.)</p><h3 id="Residual-Variance-(σ)"><a class="docs-heading-anchor" href="#Residual-Variance-(σ)">Residual Variance (σ)</a><a id="Residual-Variance-(σ)-1"></a><a class="docs-heading-anchor-permalink" href="#Residual-Variance-(σ)" title="Permalink"></a></h3><p><code>σ</code> is the <code>residual</code>-standard deviation listed under the variance components.</p><pre><code class="language-julia hljs">kb07_m.σ</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">680.0318880969241</code></pre><h3 id="Random-Effects-(θ)"><a class="docs-heading-anchor" href="#Random-Effects-(θ)">Random Effects (θ)</a><a id="Random-Effects-(θ)-1"></a><a class="docs-heading-anchor-permalink" href="#Random-Effects-(θ)" title="Permalink"></a></h3><p>The meaning of <code>θ</code> is a bit less intuitive. In a less complex model (one that only has intercepts for the random effects) or if we suppress the correlations in the formula with <code>zerocorr()</code> then <code>θ</code> describes the relationship between the standard deviation of the random effects and the residual standard deviation.</p><p>In our <code>kb07_m</code> example:</p><ul><li>The <code>residual</code> standard deviation is <code>680.032</code>.</li><li>The standard deviation of our first variance component <em><code>item (Intercept)</code></em> is <code>364.713</code>.</li><li>Thus our first <code>θ</code> is the relationship: variance component divided by <code>residual</code> standard deviation: <span>$364.713 /  680.032 =  0.53631$</span></li></ul><pre><code class="language-julia hljs">kb07_m.θ</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">4-element Vector{Float64}:
 0.5363169800143563
 0.25982004672659703
 0.26530218686528734
 0.43825259346796397</code></pre><p>We also can calculate the <code>θ</code> for variance component <em><code>subj (Intercept)</code></em>. The <code>residual</code> standard deviation is <code>680.032</code>. The standard deviation of our variance component <em><code>subj (Intercept)</code></em> is <code>298.026</code>. Thus, the related θ is the relationship: variance component divided by <code>residual</code> standard deviation 298.026 /  680.032 =  <code>0.438252</code></p><p>We can not calculate the <code>θ</code>s for variance component <em><code>item prec: break</code></em> this way, because it includes the correlation of <em><code>item prec: break</code></em> and <em><code>item (Intercept)</code></em>. But keep in mind that the relation of  <em><code>item prec: break</code></em>-variability (<code>252.521</code>) and the <code>residual</code>-variability (<code>680.032</code>) is <span>$252.521  /  680.032 =  0.3713369$</span>.</p><p>The <code>θ</code> vector is the flattened version of the lower Cholesky factor variance-covariance matrix. The Cholesky factor is in some sense a &quot;matrix square root&quot; (so like storing standard deviations instead of variances) and is a lower triangular matrix. The on-diagonal elements are just the standard deviations (the <code>σ</code>&#39;s). If all off-diagonal elements are zero, we can use our calculation above. The off-diagonal elements are covariances and correspond to the correlations (the <code>ρ</code>&#39;s). If they are unequal to zero, as it is in our <code>kb07</code>-dataset, one way to get the two missing <code>θ</code>-values is to take the values directly from the model we have already fitted.</p><p>See the two inner values:</p><pre><code class="language-julia hljs">kb07_m.θ</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">4-element Vector{Float64}:
 0.5363169800143563
 0.25982004672659703
 0.26530218686528734
 0.43825259346796397</code></pre><p>Another way is to make use of the <code>create_re()</code> function. Here you have to define the relation of all random effects variabilities to the variability of the residuals, as shown above, and the correlation-matrices.</p><p>Let&#39;s start by defining the correlation matrix for the <code>item</code>-part.</p><p>The diagonal is always <code>1.0</code> because everything is perfectly correlated with itself. The elements below the diagonal follow the same form as the <code>Corr.</code> entries in the output of <code>VarCorr()</code>. In our example the correlation of <em><code>item prec: break</code></em> and <em><code>item (Intercept)</code></em> is <code>-0.7</code>. The elements above the diagonal are just a mirror image.</p><pre><code class="language-julia hljs">re_item_corr = [1.0 -0.7; -0.7 1.0]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2×2 Matrix{Float64}:
  1.0  -0.7
 -0.7   1.0</code></pre><p>Now we put together all relations of standard deviations and the correlation-matrix for the <code>item</code>-group. This calculates the covariance factorization which is the theta matrix.</p><pre><code class="language-julia hljs">re_item = create_re(0.536, 0.371; corrmat = re_item_corr)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2×2 LinearAlgebra.LowerTriangular{Float64, Matrix{Float64}}:
  0.536    ⋅ 
 -0.2597  0.264947</code></pre><p><img src="../ThetaExplanation.png" alt="Work flow for constructing theta vector"/></p><div class="admonition is-info" id="Note-912cfedb72ad5257"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-912cfedb72ad5257" title="Permalink"></a></header><div class="admonition-body"><p>Don&#39;t be too specific with your values in <code>create_re()</code>. Generally we don&#39;t these values very precisely because estimating them precisely requires large amounts of data. Additionally, if there are numerical problems (rounding errors), you will get the error-message: <code>PosDefException: matrix is not Hermitian; Cholesky factorization failed.</code></p></div></div><p>Although we advise against using these values, you can extract the exact values like so (just as a pedagogical demonstration):</p><pre><code class="language-julia hljs">corr_exact = VarCorr(kb07_m).σρ.item.ρ[1]
σ_residuals_exact = kb07_m.σ
σ_1_exact = VarCorr(kb07_m).σρ.item.σ[1] / σ_residuals_exact
σ_2_exact = VarCorr(kb07_m).σρ.item.σ[2] / σ_residuals_exact

re_item_corr = [1.0 corr_exact; corr_exact 1.0]
re_item = create_re(σ_1_exact, σ_2_exact; corrmat = re_item_corr)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2×2 LinearAlgebra.LowerTriangular{Float64, Matrix{Float64}}:
 0.536317   ⋅ 
 0.25982   0.265302</code></pre><p>Let&#39;s continue with the <code>subj</code>-part.</p><p>Since there the by-subject random effects have only one entry (the intercept), there are no correlations to specify and we can omit the <code>corrmat</code> argument.</p><p>Now we put together all relations of standard deviations and the correlation-matrix for the <code>subj</code>-group:</p><p>This calculates the covariance factorization which is the theta matrix.</p><pre><code class="language-julia hljs">re_subj = create_re(0.438)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×1 LinearAlgebra.LowerTriangular{Float64, LinearAlgebra.Diagonal{Float64, Vector{Float64}}}:
 0.438</code></pre><p>If you want the exact value you can use</p><pre><code class="language-julia hljs">σ_residuals_exact = kb07_m.σ
σ_3_exact = VarCorr(kb07_m).σρ.subj.σ[1] / σ_residuals_exact
re_subj = create_re(σ_3_exact)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×1 LinearAlgebra.LowerTriangular{Float64, LinearAlgebra.Diagonal{Float64, Vector{Float64}}}:
 0.43825259346796397</code></pre><p>As mentioned above <code>θ</code> is the compact form of these covariance matrices:</p><pre><code class="language-julia hljs">createθ(kb07_m; item=re_item, subj=re_subj)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">4-element Vector{Float64}:
 0.5363169800143563
 0.25982004672659703
 0.2653021868652873
 0.43825259346796397</code></pre><p>The function <code>createθ</code> is putting the random effects into the correct order and then putting them into the compact form. Even for the same formula, the order may vary between datasets (and hence models fit to those datasets) because of a particular computational trick used in MixedModels.jl. Because of this trick, we need to specify the model along with the random effects so that the correct order can be determined.</p><p>We can install these parameter in the <code>parametricbootstrap()</code>-function or in the model like this:</p><pre><code class="language-julia hljs"># need the fully qualified name here because Makie also defines update!
MixedModelsSim.update!(kb07_m, item=re_item, subj=re_subj)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Linear mixed model fit by maximum likelihood
 rt_trunc ~ 1 + spkr + prec + load + (1 | subj) + (1 + prec | item)
    logLik   -2 logLik      AIC         AICc        BIC     
 -14331.9251  28663.8501  28681.8501  28681.9513  28731.2548

Variance components:
            Column    Variance  Std.Dev.  Corr.
item     (Intercept)  133015.316 364.713
         prec: break   63767.106 252.521 +0.70
subj     (Intercept)   88819.341 298.026
Residual              462443.369 680.032
 Number of obs: 1789; levels of grouping factors: 32, 56

  Fixed-effects parameters:
───────────────────────────────────────────────────
                 Coef.  Std. Error      z  Pr(&gt;|z|)
───────────────────────────────────────────────────
(Intercept)  2181.85       77.4681  28.16    &lt;1e-99
spkr: old      67.879      16.0785   4.22    &lt;1e-04
prec: break   333.791      47.4472   7.03    &lt;1e-11
load: yes      78.5904     16.0785   4.89    &lt;1e-05
───────────────────────────────────────────────────</code></pre><h2 id="A-simple-example-from-scratch"><a class="docs-heading-anchor" href="#A-simple-example-from-scratch">A simple example from scratch</a><a id="A-simple-example-from-scratch-1"></a><a class="docs-heading-anchor-permalink" href="#A-simple-example-from-scratch" title="Permalink"></a></h2><p>Having this knowledge about the parameters we can now <strong>simulate data from scratch</strong></p><p>The <code>simdat_crossed()</code> function from <code>MixedModelsSim</code> lets you set up a data frame with a specified experimental design. For now, it only makes fully balanced crossed designs, but you can generate an unbalanced design by simulating data for the largest cell and deleting extra rows.</p><p>First, we will set an easy design where <code>subj_n</code> subjects per <code>age</code> group (<code>O</code>ld or <code>Y</code>oung) respond to <code>item_n</code> items in each of two <code>condition</code>s (A or B).</p><p>Your factors need to be specified separately for between-subject, between-item, and within-subject/item factors using <code>Dict</code> with the name of each factor as the keys and vectors with the names of the levels as values.</p><p>We start with the between subject factors:</p><pre><code class="language-julia hljs">subj_btwn = Dict(:age =&gt; [&quot;O&quot;, &quot;Y&quot;])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Dict{Symbol, Vector{String}} with 1 entry:
  :age =&gt; [&quot;O&quot;, &quot;Y&quot;]</code></pre><p>There are no between-item factors in this design so you can omit it or set it to nothing. Note that if you have factors which are between subject and between item, you need to put them in both dicts.</p><pre><code class="language-julia hljs">item_btwn = nothing</code></pre><p>Next, we put within-subject/item factors in a dict:</p><pre><code class="language-julia hljs">both_win = Dict(:condition =&gt; [&quot;A&quot;, &quot;B&quot;])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Dict{Symbol, Vector{String}} with 1 entry:
  :condition =&gt; [&quot;A&quot;, &quot;B&quot;]</code></pre><p>Define subject and item number:</p><pre><code class="language-julia hljs">subj_n = 10
item_n = 30</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">30</code></pre><p>Simulate data:</p><pre><code class="language-julia hljs">dat = simdat_crossed(subj_n,
                     item_n,
                     subj_btwn = subj_btwn,
                     item_btwn = item_btwn,
                     both_win = both_win);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">600-element Vector{@NamedTuple{subj::String, age::String, item::String, condition::String, dv::Float64}}:
 (subj = &quot;S01&quot;, age = &quot;O&quot;, item = &quot;I01&quot;, condition = &quot;A&quot;, dv = 0.7885797669886646)
 (subj = &quot;S02&quot;, age = &quot;Y&quot;, item = &quot;I01&quot;, condition = &quot;A&quot;, dv = -0.49616487362724554)
 (subj = &quot;S03&quot;, age = &quot;O&quot;, item = &quot;I01&quot;, condition = &quot;A&quot;, dv = 0.8052970006718504)
 (subj = &quot;S04&quot;, age = &quot;Y&quot;, item = &quot;I01&quot;, condition = &quot;A&quot;, dv = -0.11741917533217676)
 (subj = &quot;S05&quot;, age = &quot;O&quot;, item = &quot;I01&quot;, condition = &quot;A&quot;, dv = 0.8158945138818956)
 (subj = &quot;S06&quot;, age = &quot;Y&quot;, item = &quot;I01&quot;, condition = &quot;A&quot;, dv = 1.2997978817750755)
 (subj = &quot;S07&quot;, age = &quot;O&quot;, item = &quot;I01&quot;, condition = &quot;A&quot;, dv = 0.09185644411482)
 (subj = &quot;S08&quot;, age = &quot;Y&quot;, item = &quot;I01&quot;, condition = &quot;A&quot;, dv = 1.3479165609864867)
 (subj = &quot;S09&quot;, age = &quot;O&quot;, item = &quot;I01&quot;, condition = &quot;A&quot;, dv = -0.9066550167335599)
 (subj = &quot;S10&quot;, age = &quot;Y&quot;, item = &quot;I01&quot;, condition = &quot;A&quot;, dv = -0.32937683959916)
 ⋮
 (subj = &quot;S02&quot;, age = &quot;Y&quot;, item = &quot;I30&quot;, condition = &quot;B&quot;, dv = -1.3183331708574593)
 (subj = &quot;S03&quot;, age = &quot;O&quot;, item = &quot;I30&quot;, condition = &quot;B&quot;, dv = -0.8633344496531067)
 (subj = &quot;S04&quot;, age = &quot;Y&quot;, item = &quot;I30&quot;, condition = &quot;B&quot;, dv = 1.1708019044886377)
 (subj = &quot;S05&quot;, age = &quot;O&quot;, item = &quot;I30&quot;, condition = &quot;B&quot;, dv = 1.1599768007409343)
 (subj = &quot;S06&quot;, age = &quot;Y&quot;, item = &quot;I30&quot;, condition = &quot;B&quot;, dv = -0.7165528488210101)
 (subj = &quot;S07&quot;, age = &quot;O&quot;, item = &quot;I30&quot;, condition = &quot;B&quot;, dv = -1.1705729836763694)
 (subj = &quot;S08&quot;, age = &quot;Y&quot;, item = &quot;I30&quot;, condition = &quot;B&quot;, dv = -0.8079999238631068)
 (subj = &quot;S09&quot;, age = &quot;O&quot;, item = &quot;I30&quot;, condition = &quot;B&quot;, dv = -1.5996503824150576)
 (subj = &quot;S10&quot;, age = &quot;Y&quot;, item = &quot;I30&quot;, condition = &quot;B&quot;, dv = -1.5250619373968213)</code></pre><p>Have a look:</p><pre><code class="language-julia hljs">first(DataFrame(dat),8)</code></pre><div><div style = "float: left;"><span>8×5 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">subj</th><th style = "text-align: left;">age</th><th style = "text-align: left;">item</th><th style = "text-align: left;">condition</th><th style = "text-align: left;">dv</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">S01</td><td style = "text-align: left;">O</td><td style = "text-align: left;">I01</td><td style = "text-align: left;">A</td><td style = "text-align: right;">0.78858</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">S02</td><td style = "text-align: left;">Y</td><td style = "text-align: left;">I01</td><td style = "text-align: left;">A</td><td style = "text-align: right;">-0.496165</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">S03</td><td style = "text-align: left;">O</td><td style = "text-align: left;">I01</td><td style = "text-align: left;">A</td><td style = "text-align: right;">0.805297</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">S04</td><td style = "text-align: left;">Y</td><td style = "text-align: left;">I01</td><td style = "text-align: left;">A</td><td style = "text-align: right;">-0.117419</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">S05</td><td style = "text-align: left;">O</td><td style = "text-align: left;">I01</td><td style = "text-align: left;">A</td><td style = "text-align: right;">0.815895</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">S06</td><td style = "text-align: left;">Y</td><td style = "text-align: left;">I01</td><td style = "text-align: left;">A</td><td style = "text-align: right;">1.2998</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">S07</td><td style = "text-align: left;">O</td><td style = "text-align: left;">I01</td><td style = "text-align: left;">A</td><td style = "text-align: right;">0.0918564</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: left;">S08</td><td style = "text-align: left;">Y</td><td style = "text-align: left;">I01</td><td style = "text-align: left;">A</td><td style = "text-align: right;">1.34792</td></tr></tbody></table></div><p>The values we see in the column <code>dv</code> is just random noise (drawn from the standard normal distribution)</p><p>Set contrasts:</p><pre><code class="language-julia hljs">contrasts = Dict(:age =&gt; HelmertCoding(),
                 :condition =&gt; HelmertCoding(),
                 :subj =&gt; Grouping(),
                 :item =&gt; Grouping());</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Dict{Symbol, StatsModels.AbstractContrasts} with 4 entries:
  :item      =&gt; Grouping()
  :age       =&gt; HelmertCoding(nothing, nothing)
  :condition =&gt; HelmertCoding(nothing, nothing)
  :subj      =&gt; Grouping()</code></pre><p>Define formula:</p><pre><code class="language-julia hljs">f1 = @formula(dv ~ 1 + age * condition + (1|item) + (1|subj));</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">FormulaTerm
Response:
  dv(unknown)
Predictors:
  1
  age(unknown)
  condition(unknown)
  age(unknown) &amp; condition(unknown)
  (item)-&gt;1 | item
  (subj)-&gt;1 | subj</code></pre><p>Note that we did not include condition as random slopes for item and subject. This is mainly to keep the example simple and to keep the parameter <code>θ</code> easier to understand (see Section 3 above for the explanation of θ).</p><p>Fit the model:</p><pre><code class="language-julia hljs">m1 = fit(MixedModel, f1, dat; contrasts=contrasts)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Linear mixed model fit by maximum likelihood
 dv ~ 1 + age + condition + age &amp; condition + (1 | item) + (1 | subj)
   logLik   -2 logLik     AIC       AICc        BIC    
  -860.5059  1721.0119  1735.0119  1735.2010  1765.7904

Variance components:
            Column   VarianceStd.Dev.
item     (Intercept)  0.00000 0.00000
subj     (Intercept)  0.00000 0.00000
Residual              1.03095 1.01535
 Number of obs: 600; levels of grouping factors: 30, 10

  Fixed-effects parameters:
──────────────────────────────────────────────────────────────
                            Coef.  Std. Error      z  Pr(&gt;|z|)
──────────────────────────────────────────────────────────────
(Intercept)             0.0703081   0.0414517   1.70    0.0899
age: Y                  0.0670717   0.0414517   1.62    0.1056
condition: B           -0.0995685   0.0414517  -2.40    0.0163
age: Y &amp; condition: B  -0.0267638   0.0414517  -0.65    0.5185
──────────────────────────────────────────────────────────────</code></pre><p>Because the <code>dv</code> is just random noise from N(0,1), there will be basically no subject or item random variance, residual variance will be near 1.0, and the estimates for all effects should be small. Don&#39;t worry, we&#39;ll specify fixed and random effects directly in <code>parametricbootstrap()</code>.</p><p>Set random seed for reproducibility:</p><pre><code class="language-julia hljs">rng = StableRNG(42);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">StableRNGs.LehmerRNG(state=0x00000000000000000000000000000055)</code></pre><p>Specify <code>β</code>, <code>σ</code>, and <code>θ</code>, we just made up this parameter:</p><pre><code class="language-julia hljs">new_beta = [0., 0.25, 0.25, 0.]
new_sigma = 2.0
new_theta = [1.0, 1.0]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Float64}:
 1.0
 1.0</code></pre><p>Run nsims iterations:</p><pre><code class="language-julia hljs">sim1 = parametricbootstrap(rng, nsims, m1;
                           β = new_beta,
                           σ = new_sigma,
                           θ = new_theta);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">MixedModelBootstrap with 100 samples
     parameter  min        q25         median      mean         q75       ⋯
   ┌───────────────────────────────────────────────────────────────────────
 1 │ β1         -1.91722   -0.327597   0.210513    0.125857     0.583837  ⋯
 2 │ β2         -1.35913   -0.158688   0.361579    0.352458     0.888642  ⋯
 3 │ β3         0.0618462  0.187246    0.251725    0.248267     0.303721  ⋯
 4 │ β4         -0.22035   -0.0530245  -0.0126518  -0.00511795  0.051643  ⋯
 5 │ σ          1.81734    1.95216     2.00679     1.9932       2.03363   ⋯
 6 │ σ1         1.29715    1.82294     1.99914     2.00614      2.22138   ⋯
 7 │ σ2         1.01407    1.55278     1.83232     1.83316      2.09607   ⋯
 8 │ θ1         0.633916   0.901324    1.01477     1.00645      1.11295   ⋯
 9 │ θ2         0.475464   0.780099    0.898011    0.920961     1.05958   ⋯
</code></pre><h3 id="Power-calculation-3"><a class="docs-heading-anchor" href="#Power-calculation-3">Power calculation</a><a class="docs-heading-anchor-permalink" href="#Power-calculation-3" title="Permalink"></a></h3><pre><code class="language-julia hljs">ptbl= power_table(sim1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">4-element Vector{@NamedTuple{coefname::String, power::Float64}}:
 (coefname = &quot;age: Y&quot;, power = 0.23)
 (coefname = &quot;condition: B&quot;, power = 0.86)
 (coefname = &quot;(Intercept)&quot;, power = 0.08)
 (coefname = &quot;age: Y &amp; condition: B&quot;, power = 0.04)</code></pre><p>For nicely displaying it, you can use pretty_table:</p><pre><code class="language-julia hljs">pretty_table(ptbl)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">┌───────────────────────┬─────────┐
│<span class="sgr1">              coefname </span>│<span class="sgr1">   power </span>│
│<span class="sgr90">                String </span>│<span class="sgr90"> Float64 </span>│
├───────────────────────┼─────────┤
│                age: Y │    0.23 │
│          condition: B │    0.86 │
│           (Intercept) │    0.08 │
│ age: Y &amp; condition: B │    0.04 │
└───────────────────────┴─────────┘</code></pre><h2 id="Compute-power-curves-for-a-more-complex-dataset"><a class="docs-heading-anchor" href="#Compute-power-curves-for-a-more-complex-dataset">Compute power curves for a more complex dataset</a><a id="Compute-power-curves-for-a-more-complex-dataset-1"></a><a class="docs-heading-anchor-permalink" href="#Compute-power-curves-for-a-more-complex-dataset" title="Permalink"></a></h2><h3 id="Recreate-the-kb07-dataset-from-scratch"><a class="docs-heading-anchor" href="#Recreate-the-kb07-dataset-from-scratch">Recreate the <code>kb07</code>-dataset from scratch</a><a id="Recreate-the-kb07-dataset-from-scratch-1"></a><a class="docs-heading-anchor-permalink" href="#Recreate-the-kb07-dataset-from-scratch" title="Permalink"></a></h3><p>For full control over all parameters in our <code>kb07</code> data set we will recreate the design using the method shown above.</p><p>Define subject and item number:</p><pre><code class="language-julia hljs">subj_n = 56
item_n = 32</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">32</code></pre><p>Define factors in a dict:</p><pre><code class="language-julia hljs">subj_btwn = nothing
item_btwn = nothing
both_win = Dict(:spkr =&gt; [&quot;old&quot;, &quot;new&quot;],
                :prec =&gt; [&quot;maintain&quot;, &quot;break&quot;],
                :load =&gt; [&quot;yes&quot;, &quot;no&quot;]);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Dict{Symbol, Vector{String}} with 3 entries:
  :spkr =&gt; [&quot;old&quot;, &quot;new&quot;]
  :load =&gt; [&quot;yes&quot;, &quot;no&quot;]
  :prec =&gt; [&quot;maintain&quot;, &quot;break&quot;]</code></pre><p><strong>Try</strong>: Play with <code>simdat_crossed</code>.</p><p>Simulate data:</p><pre><code class="language-julia hljs">fake_kb07 = simdat_crossed(subj_n, item_n,
                           subj_btwn = subj_btwn,
                           item_btwn = item_btwn,
                           both_win = both_win);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">14336-element Vector{@NamedTuple{subj::String, item::String, spkr::String, load::String, prec::String, dv::Float64}}:
 (subj = &quot;S01&quot;, item = &quot;I01&quot;, spkr = &quot;old&quot;, load = &quot;yes&quot;, prec = &quot;maintain&quot;, dv = 0.0003158444455244356)
 (subj = &quot;S02&quot;, item = &quot;I01&quot;, spkr = &quot;old&quot;, load = &quot;yes&quot;, prec = &quot;maintain&quot;, dv = 1.3816769220664755)
 (subj = &quot;S03&quot;, item = &quot;I01&quot;, spkr = &quot;old&quot;, load = &quot;yes&quot;, prec = &quot;maintain&quot;, dv = 0.6892628186729304)
 (subj = &quot;S04&quot;, item = &quot;I01&quot;, spkr = &quot;old&quot;, load = &quot;yes&quot;, prec = &quot;maintain&quot;, dv = -1.6709276724407693)
 (subj = &quot;S05&quot;, item = &quot;I01&quot;, spkr = &quot;old&quot;, load = &quot;yes&quot;, prec = &quot;maintain&quot;, dv = 0.832976685834326)
 (subj = &quot;S06&quot;, item = &quot;I01&quot;, spkr = &quot;old&quot;, load = &quot;yes&quot;, prec = &quot;maintain&quot;, dv = 1.8749017822301415)
 (subj = &quot;S07&quot;, item = &quot;I01&quot;, spkr = &quot;old&quot;, load = &quot;yes&quot;, prec = &quot;maintain&quot;, dv = -0.933489427225352)
 (subj = &quot;S08&quot;, item = &quot;I01&quot;, spkr = &quot;old&quot;, load = &quot;yes&quot;, prec = &quot;maintain&quot;, dv = 0.557955774788614)
 (subj = &quot;S09&quot;, item = &quot;I01&quot;, spkr = &quot;old&quot;, load = &quot;yes&quot;, prec = &quot;maintain&quot;, dv = -1.7973854049860125)
 (subj = &quot;S10&quot;, item = &quot;I01&quot;, spkr = &quot;old&quot;, load = &quot;yes&quot;, prec = &quot;maintain&quot;, dv = -0.4133423523941382)
 ⋮
 (subj = &quot;S48&quot;, item = &quot;I32&quot;, spkr = &quot;new&quot;, load = &quot;no&quot;, prec = &quot;break&quot;, dv = 0.36572282976008114)
 (subj = &quot;S49&quot;, item = &quot;I32&quot;, spkr = &quot;new&quot;, load = &quot;no&quot;, prec = &quot;break&quot;, dv = -0.4275432209181431)
 (subj = &quot;S50&quot;, item = &quot;I32&quot;, spkr = &quot;new&quot;, load = &quot;no&quot;, prec = &quot;break&quot;, dv = -1.268876522713879)
 (subj = &quot;S51&quot;, item = &quot;I32&quot;, spkr = &quot;new&quot;, load = &quot;no&quot;, prec = &quot;break&quot;, dv = 0.6595156207095522)
 (subj = &quot;S52&quot;, item = &quot;I32&quot;, spkr = &quot;new&quot;, load = &quot;no&quot;, prec = &quot;break&quot;, dv = -0.2475030885604881)
 (subj = &quot;S53&quot;, item = &quot;I32&quot;, spkr = &quot;new&quot;, load = &quot;no&quot;, prec = &quot;break&quot;, dv = 1.01990818721732)
 (subj = &quot;S54&quot;, item = &quot;I32&quot;, spkr = &quot;new&quot;, load = &quot;no&quot;, prec = &quot;break&quot;, dv = -0.48425452019167575)
 (subj = &quot;S55&quot;, item = &quot;I32&quot;, spkr = &quot;new&quot;, load = &quot;no&quot;, prec = &quot;break&quot;, dv = 0.20089357579286482)
 (subj = &quot;S56&quot;, item = &quot;I32&quot;, spkr = &quot;new&quot;, load = &quot;no&quot;, prec = &quot;break&quot;, dv = -0.71562885310344)</code></pre><p>Make a dataframe:</p><pre><code class="language-julia hljs">fake_kb07_df = DataFrame(fake_kb07);</code></pre><p>Have a look:</p><pre><code class="language-julia hljs">first(fake_kb07_df,8)</code></pre><div><div style = "float: left;"><span>8×6 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">subj</th><th style = "text-align: left;">item</th><th style = "text-align: left;">spkr</th><th style = "text-align: left;">load</th><th style = "text-align: left;">prec</th><th style = "text-align: left;">dv</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">S01</td><td style = "text-align: left;">I01</td><td style = "text-align: left;">old</td><td style = "text-align: left;">yes</td><td style = "text-align: left;">maintain</td><td style = "text-align: right;">0.000315844</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">S02</td><td style = "text-align: left;">I01</td><td style = "text-align: left;">old</td><td style = "text-align: left;">yes</td><td style = "text-align: left;">maintain</td><td style = "text-align: right;">1.38168</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">S03</td><td style = "text-align: left;">I01</td><td style = "text-align: left;">old</td><td style = "text-align: left;">yes</td><td style = "text-align: left;">maintain</td><td style = "text-align: right;">0.689263</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">S04</td><td style = "text-align: left;">I01</td><td style = "text-align: left;">old</td><td style = "text-align: left;">yes</td><td style = "text-align: left;">maintain</td><td style = "text-align: right;">-1.67093</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">S05</td><td style = "text-align: left;">I01</td><td style = "text-align: left;">old</td><td style = "text-align: left;">yes</td><td style = "text-align: left;">maintain</td><td style = "text-align: right;">0.832977</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">S06</td><td style = "text-align: left;">I01</td><td style = "text-align: left;">old</td><td style = "text-align: left;">yes</td><td style = "text-align: left;">maintain</td><td style = "text-align: right;">1.8749</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">S07</td><td style = "text-align: left;">I01</td><td style = "text-align: left;">old</td><td style = "text-align: left;">yes</td><td style = "text-align: left;">maintain</td><td style = "text-align: right;">-0.933489</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: left;">S08</td><td style = "text-align: left;">I01</td><td style = "text-align: left;">old</td><td style = "text-align: left;">yes</td><td style = "text-align: left;">maintain</td><td style = "text-align: right;">0.557956</td></tr></tbody></table></div><p>The function <code>simdat_crossed</code> generates a balanced fully crossed design. Unfortunately, our original design is not balanced fully crossed. Every subject saw an image only once, thus in one of eight possible conditions. To simulate that we only keep one of every eight lines.</p><p>We sort the dataframe to enable easier selection</p><pre><code class="language-julia hljs">sort!(fake_kb07_df, [:subj, :item, :load, :prec, :spkr])</code></pre><p>In order to select only the relevant rows of the data set we define an index which represents a random choice of one of every eight rows. First we generate a vector <code>idx</code> which represents which row to keep in each set of 8.</p><pre><code class="language-julia hljs">len = div(length(fake_kb07), 8) # integer division
idx = rand(rng, 1:8 , len)
show(idx)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[8, 7, 7, 6, 1, 8, 7, 3, 1, 6, 4, 6, 2, 3, 5, 8, 3, 1, 2, 7, 2, 2, 3, 2, 5, 7, 3, 6, 1, 6, 2, 6, 6, 2, 6, 3, 3, 7, 6, 3, 1, 1, 6, 2, 4, 6, 3, 4, 8, 3, 5, 5, 5, 6, 4, 6, 8, 6, 8, 6, 6, 7, 3, 1, 2, 4, 4, 2, 7, 2, 3, 4, 2, 7, 5, 8, 3, 6, 4, 3, 6, 1, 5, 8, 4, 7, 5, 1, 8, 4, 7, 4, 2, 4, 6, 7, 2, 3, 2, 6, 8, 1, 4, 6, 8, 8, 5, 7, 2, 2, 2, 6, 8, 8, 2, 8, 5, 1, 3, 1, 3, 7, 3, 1, 7, 6, 5, 1, 1, 4, 3, 3, 8, 2, 7, 1, 6, 6, 3, 5, 7, 3, 2, 3, 6, 5, 2, 8, 5, 1, 4, 4, 2, 8, 6, 1, 7, 8, 7, 2, 4, 8, 5, 8, 4, 7, 7, 2, 4, 8, 7, 1, 2, 5, 4, 4, 5, 3, 7, 6, 4, 6, 8, 7, 7, 5, 6, 1, 1, 6, 2, 3, 1, 4, 4, 7, 1, 2, 1, 6, 7, 2, 5, 3, 2, 4, 6, 4, 4, 1, 5, 4, 2, 4, 3, 7, 4, 7, 4, 1, 3, 2, 4, 1, 6, 4, 1, 3, 1, 8, 8, 5, 4, 4, 3, 3, 6, 6, 5, 5, 7, 8, 7, 8, 1, 2, 4, 3, 3, 5, 6, 7, 6, 8, 1, 6, 2, 1, 3, 7, 1, 6, 1, 5, 7, 3, 8, 5, 1, 2, 6, 3, 1, 8, 4, 6, 7, 7, 3, 3, 5, 4, 7, 2, 7, 8, 2, 3, 3, 8, 7, 8, 6, 3, 8, 5, 5, 2, 5, 3, 1, 2, 6, 2, 4, 8, 8, 8, 1, 1, 4, 1, 2, 6, 1, 7, 3, 3, 5, 1, 6, 3, 2, 5, 5, 5, 4, 3, 6, 1, 2, 7, 1, 5, 2, 2, 5, 1, 3, 8, 4, 3, 1, 5, 1, 7, 5, 2, 5, 5, 5, 2, 6, 5, 5, 8, 2, 4, 5, 7, 8, 3, 7, 2, 3, 5, 1, 6, 3, 8, 4, 8, 8, 2, 6, 6, 7, 2, 7, 7, 3, 2, 8, 1, 5, 4, 4, 3, 4, 1, 5, 2, 6, 2, 7, 8, 7, 3, 3, 4, 3, 4, 2, 3, 8, 5, 8, 1, 2, 3, 1, 2, 3, 6, 2, 5, 1, 2, 4, 8, 6, 6, 3, 1, 5, 6, 2, 1, 3, 4, 7, 4, 6, 4, 5, 4, 3, 6, 6, 3, 4, 7, 2, 8, 8, 5, 4, 1, 5, 6, 4, 7, 5, 1, 8, 2, 2, 7, 4, 3, 7, 5, 2, 7, 1, 3, 7, 1, 2, 6, 1, 1, 2, 5, 4, 5, 8, 3, 3, 3, 6, 4, 6, 5, 4, 4, 8, 1, 5, 8, 4, 6, 1, 4, 4, 7, 3, 8, 4, 8, 6, 2, 3, 4, 2, 7, 2, 4, 3, 7, 6, 2, 7, 5, 2, 7, 4, 3, 3, 2, 8, 3, 2, 3, 2, 7, 5, 8, 6, 4, 3, 1, 8, 7, 8, 3, 7, 6, 2, 5, 4, 6, 6, 1, 8, 8, 4, 3, 6, 2, 6, 6, 4, 3, 6, 1, 5, 4, 2, 2, 1, 3, 5, 6, 5, 8, 7, 2, 6, 6, 7, 1, 5, 3, 7, 3, 8, 8, 1, 7, 4, 8, 3, 6, 6, 1, 4, 3, 7, 8, 4, 3, 5, 2, 3, 8, 7, 6, 6, 6, 4, 7, 3, 7, 2, 1, 7, 2, 4, 7, 1, 1, 2, 8, 1, 6, 4, 6, 6, 2, 5, 3, 5, 8, 6, 6, 3, 6, 7, 7, 5, 8, 3, 6, 6, 8, 8, 6, 1, 6, 8, 7, 7, 7, 6, 6, 3, 5, 4, 7, 2, 2, 6, 2, 1, 6, 8, 1, 6, 7, 7, 7, 7, 1, 1, 1, 4, 4, 3, 1, 2, 8, 7, 3, 3, 6, 5, 2, 7, 3, 6, 4, 2, 6, 5, 4, 8, 5, 3, 2, 6, 7, 8, 6, 5, 8, 1, 1, 7, 4, 1, 4, 4, 1, 6, 1, 2, 1, 2, 8, 2, 7, 5, 4, 5, 2, 6, 7, 7, 2, 7, 6, 3, 6, 6, 6, 4, 5, 1, 7, 1, 7, 3, 4, 5, 6, 3, 1, 5, 3, 2, 3, 8, 7, 3, 3, 3, 4, 4, 8, 2, 1, 6, 2, 4, 5, 4, 6, 2, 1, 7, 8, 1, 5, 4, 6, 1, 3, 7, 8, 8, 5, 8, 7, 1, 1, 7, 2, 7, 8, 8, 4, 1, 4, 8, 3, 5, 2, 3, 4, 1, 6, 6, 2, 2, 5, 5, 2, 2, 8, 2, 3, 7, 1, 5, 7, 6, 3, 1, 6, 6, 6, 3, 7, 5, 7, 7, 7, 4, 8, 1, 1, 6, 2, 8, 4, 6, 2, 3, 6, 8, 4, 7, 7, 3, 2, 3, 3, 7, 3, 7, 4, 7, 5, 5, 1, 6, 4, 6, 3, 6, 1, 7, 3, 7, 5, 7, 6, 4, 4, 6, 7, 2, 2, 4, 5, 6, 7, 8, 4, 5, 3, 5, 3, 8, 2, 6, 6, 7, 3, 8, 8, 6, 6, 6, 4, 8, 2, 5, 4, 4, 3, 4, 4, 7, 6, 6, 5, 7, 4, 8, 4, 4, 6, 8, 5, 7, 6, 3, 2, 3, 7, 1, 1, 3, 3, 3, 4, 7, 8, 7, 2, 5, 1, 6, 7, 3, 1, 5, 2, 4, 5, 5, 1, 5, 7, 4, 4, 7, 5, 6, 8, 6, 3, 5, 3, 8, 3, 4, 8, 5, 6, 2, 2, 2, 6, 2, 7, 2, 4, 7, 8, 6, 7, 8, 3, 4, 6, 3, 2, 2, 6, 2, 4, 6, 7, 2, 8, 7, 2, 8, 5, 3, 6, 3, 7, 5, 4, 3, 1, 6, 6, 7, 6, 3, 5, 3, 2, 6, 4, 4, 1, 7, 7, 5, 5, 5, 7, 4, 6, 1, 2, 7, 7, 8, 4, 4, 1, 1, 5, 3, 5, 3, 7, 8, 5, 6, 7, 2, 3, 1, 5, 4, 1, 4, 7, 2, 6, 8, 1, 3, 7, 3, 1, 8, 7, 7, 4, 7, 4, 1, 7, 5, 7, 1, 1, 2, 4, 4, 1, 8, 3, 5, 2, 7, 5, 2, 5, 6, 8, 5, 5, 7, 1, 3, 8, 1, 1, 2, 4, 7, 6, 4, 8, 5, 4, 5, 6, 3, 3, 7, 8, 8, 6, 6, 2, 4, 7, 5, 6, 8, 2, 2, 4, 7, 2, 7, 6, 8, 7, 2, 8, 4, 2, 6, 6, 4, 3, 5, 7, 8, 1, 5, 7, 5, 6, 7, 4, 1, 3, 4, 7, 3, 7, 1, 6, 6, 2, 4, 1, 1, 5, 5, 5, 4, 6, 8, 6, 2, 2, 6, 3, 5, 7, 6, 4, 6, 4, 8, 8, 7, 1, 4, 2, 6, 5, 2, 6, 7, 5, 7, 5, 3, 2, 1, 6, 6, 1, 6, 5, 6, 6, 8, 5, 3, 3, 4, 2, 3, 6, 2, 7, 1, 6, 2, 3, 3, 8, 8, 7, 5, 4, 8, 5, 5, 7, 7, 4, 8, 5, 2, 5, 7, 3, 8, 5, 7, 1, 5, 3, 5, 7, 6, 6, 6, 1, 2, 7, 3, 6, 2, 2, 3, 5, 3, 8, 8, 6, 4, 6, 6, 5, 3, 1, 8, 8, 6, 1, 6, 7, 1, 8, 6, 2, 7, 6, 8, 4, 2, 4, 4, 8, 1, 2, 3, 7, 5, 1, 3, 4, 7, 8, 6, 7, 4, 6, 5, 3, 6, 6, 1, 2, 7, 4, 2, 6, 6, 5, 5, 3, 3, 7, 3, 6, 8, 4, 7, 5, 3, 5, 8, 6, 3, 3, 3, 1, 7, 6, 2, 2, 4, 8, 3, 5, 8, 8, 3, 7, 4, 4, 7, 8, 4, 5, 5, 2, 7, 8, 7, 4, 6, 5, 7, 6, 7, 7, 2, 2, 7, 7, 5, 2, 6, 8, 4, 8, 6, 1, 8, 1, 7, 8, 2, 7, 7, 5, 6, 7, 4, 2, 3, 6, 4, 7, 8, 8, 6, 1, 5, 6, 5, 5, 8, 2, 6, 5, 6, 1, 4, 1, 8, 6, 7, 2, 5, 3, 2, 3, 6, 6, 2, 4, 7, 8, 7, 1, 3, 7, 8, 2, 2, 3, 4, 4, 6, 1, 1, 6, 3, 7, 4, 6, 8, 2, 4, 6, 3, 2, 2, 8, 1, 6, 7, 3, 1, 5, 3, 7, 6, 7, 2, 7, 4, 3, 8, 4, 6, 1, 4, 1, 2, 6, 1, 7, 5, 4, 6, 7, 3, 7, 3, 5, 7, 2, 7, 4, 7, 1, 8, 1, 5, 1, 3, 3, 8, 6, 1, 7, 8, 3, 4, 4, 3, 3, 2, 7, 5, 3, 6, 1, 1, 6, 2, 1, 5, 7, 2, 7, 2, 5, 1, 6, 4, 8, 4, 2, 8, 2, 1, 4, 8, 8, 3, 3, 2, 3, 3, 5, 1, 3, 7, 4, 2, 7, 5, 8, 3, 5, 2, 4, 6, 5, 5, 5, 1, 2, 4, 7, 1, 4, 2, 6, 8, 5, 4, 4, 4, 1, 1, 5, 6, 3, 7, 2, 2, 4, 4, 6, 4, 2, 2, 4, 8, 4, 2, 8, 4, 2, 4, 4, 4, 5, 2, 1, 1, 7, 6, 8, 7, 6, 3, 1, 2, 1, 2, 2, 5, 3, 5, 4, 6, 4, 6, 2, 3, 4, 8, 7, 8, 6, 1, 8, 1, 4, 1, 4, 5, 2, 3, 2, 2, 6, 7, 4, 8, 7, 8, 5, 7, 7, 8, 2, 2, 4, 5, 2, 8, 8, 5, 8, 7, 7, 1, 2, 6, 4, 6, 2, 6, 1, 2, 6, 2, 7, 1, 3, 2, 4, 2, 5, 7, 4, 5, 6, 6, 7, 4, 6, 8, 5, 2, 3, 8, 8, 7, 8, 2, 4, 7, 5, 1, 7, 7, 1, 5, 8, 8, 4, 5, 4, 6, 4, 8, 7, 2, 3, 5, 6, 5, 2, 6, 7, 2, 2, 4, 8, 6, 5, 7, 3, 8, 1, 2, 6, 3, 7, 3, 2, 2, 3, 2, 7, 8, 5, 8, 4, 4, 7, 6, 5, 6, 7, 5, 5, 4, 3, 4, 3, 5, 7, 8, 3, 5, 3, 3, 5, 5, 4, 4, 1, 6, 5, 1, 6, 3, 2, 5, 2, 8, 3, 5, 1, 5, 2, 6, 2, 3, 3, 8, 5, 6, 7, 3, 2, 2, 4, 1, 7, 8, 6, 8, 2, 5, 8, 3, 8, 2, 8, 8, 1, 2, 1, 1, 7, 2, 2, 3, 8, 4, 7, 6, 6, 5, 8, 6, 5, 5, 7, 6, 7, 2, 1]</code></pre><p>Then we create an array <code>A</code>, of the same length that is populated multiples of the number 8. Added together <code>A</code> and <code>idx</code> give the indexes of one row from each set of 8s.</p><pre><code class="language-julia hljs">A = repeat([8], inner=len-1)
push!(A, 0)
A = cumsum(A)
idx = idx .+ A
show(idx)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[16, 23, 31, 38, 41, 56, 63, 67, 73, 86, 92, 102, 106, 115, 125, 136, 139, 145, 154, 167, 170, 178, 187, 194, 205, 215, 219, 230, 233, 246, 250, 262, 270, 274, 286, 291, 299, 311, 318, 323, 329, 337, 350, 354, 364, 374, 379, 388, 400, 403, 413, 421, 429, 438, 444, 454, 464, 470, 480, 486, 494, 503, 507, 513, 522, 532, 540, 546, 559, 562, 571, 580, 586, 599, 605, 616, 619, 630, 636, 643, 654, 657, 669, 680, 684, 695, 701, 705, 720, 724, 735, 740, 746, 756, 766, 775, 778, 787, 794, 806, 816, 817, 828, 838, 848, 856, 861, 871, 874, 882, 890, 902, 912, 920, 922, 936, 941, 945, 955, 961, 971, 983, 987, 993, 1007, 1014, 1021, 1025, 1033, 1044, 1051, 1059, 1072, 1074, 1087, 1089, 1102, 1110, 1115, 1125, 1135, 1139, 1146, 1155, 1166, 1173, 1178, 1192, 1197, 1201, 1212, 1220, 1226, 1240, 1246, 1249, 1263, 1272, 1279, 1282, 1292, 1304, 1309, 1320, 1324, 1335, 1343, 1346, 1356, 1368, 1375, 1377, 1386, 1397, 1404, 1412, 1421, 1427, 1439, 1446, 1452, 1462, 1472, 1479, 1487, 1493, 1502, 1505, 1513, 1526, 1530, 1539, 1545, 1556, 1564, 1575, 1577, 1586, 1593, 1606, 1615, 1618, 1629, 1635, 1642, 1652, 1662, 1668, 1676, 1681, 1693, 1700, 1706, 1716, 1723, 1735, 1740, 1751, 1756, 1761, 1771, 1778, 1788, 1793, 1806, 1812, 1817, 1827, 1833, 1848, 1856, 1861, 1868, 1876, 1883, 1891, 1902, 1910, 1917, 1925, 1935, 1944, 1951, 1960, 1961, 1970, 1980, 1987, 1995, 2005, 2014, 2023, 2030, 2040, 2041, 2054, 2058, 2065, 2075, 2087, 2089, 2102, 2105, 2117, 2127, 2131, 2144, 2149, 2153, 2162, 2174, 2179, 2185, 2200, 2204, 2214, 2223, 2231, 2235, 2243, 2253, 2260, 2271, 2274, 2287, 2296, 2298, 2307, 2315, 2328, 2335, 2344, 2350, 2355, 2368, 2373, 2381, 2386, 2397, 2403, 2409, 2418, 2430, 2434, 2444, 2456, 2464, 2472, 2473, 2481, 2492, 2497, 2506, 2518, 2521, 2535, 2539, 2547, 2557, 2561, 2574, 2579, 2586, 2597, 2605, 2613, 2620, 2627, 2638, 2641, 2650, 2663, 2665, 2677, 2682, 2690, 2701, 2705, 2715, 2728, 2732, 2739, 2745, 2757, 2761, 2775, 2781, 2786, 2797, 2805, 2813, 2818, 2830, 2837, 2845, 2856, 2858, 2868, 2877, 2887, 2896, 2899, 2911, 2914, 2923, 2933, 2937, 2950, 2955, 2968, 2972, 2984, 2992, 2994, 3006, 3014, 3023, 3026, 3039, 3047, 3051, 3058, 3072, 3073, 3085, 3092, 3100, 3107, 3116, 3121, 3133, 3138, 3150, 3154, 3167, 3176, 3183, 3187, 3195, 3204, 3211, 3220, 3226, 3235, 3248, 3253, 3264, 3265, 3274, 3283, 3289, 3298, 3307, 3318, 3322, 3333, 3337, 3346, 3356, 3368, 3374, 3382, 3387, 3393, 3405, 3414, 3418, 3425, 3435, 3444, 3455, 3460, 3470, 3476, 3485, 3492, 3499, 3510, 3518, 3523, 3532, 3543, 3546, 3560, 3568, 3573, 3580, 3585, 3597, 3606, 3612, 3623, 3629, 3633, 3648, 3650, 3658, 3671, 3676, 3683, 3695, 3701, 3706, 3719, 3721, 3731, 3743, 3745, 3754, 3766, 3769, 3777, 3786, 3797, 3804, 3813, 3824, 3827, 3835, 3843, 3854, 3860, 3870, 3877, 3884, 3892, 3904, 3905, 3917, 3928, 3932, 3942, 3945, 3956, 3964, 3975, 3979, 3992, 3996, 4008, 4014, 4018, 4027, 4036, 4042, 4055, 4058, 4068, 4075, 4087, 4094, 4098, 4111, 4117, 4122, 4135, 4140, 4147, 4155, 4162, 4176, 4179, 4186, 4195, 4202, 4215, 4221, 4232, 4238, 4244, 4251, 4257, 4272, 4279, 4288, 4291, 4303, 4310, 4314, 4325, 4332, 4342, 4350, 4353, 4368, 4376, 4380, 4387, 4398, 4402, 4414, 4422, 4428, 4435, 4446, 4449, 4461, 4468, 4474, 4482, 4489, 4499, 4509, 4518, 4525, 4536, 4543, 4546, 4558, 4566, 4575, 4577, 4589, 4595, 4607, 4611, 4624, 4632, 4633, 4647, 4652, 4664, 4667, 4678, 4686, 4689, 4700, 4707, 4719, 4728, 4732, 4739, 4749, 4754, 4763, 4776, 4783, 4790, 4798, 4806, 4812, 4823, 4827, 4839, 4842, 4849, 4863, 4866, 4876, 4887, 4889, 4897, 4906, 4920, 4921, 4934, 4940, 4950, 4958, 4962, 4973, 4979, 4989, 5000, 5006, 5014, 5019, 5030, 5039, 5047, 5053, 5064, 5067, 5078, 5086, 5096, 5104, 5110, 5113, 5126, 5136, 5143, 5151, 5159, 5166, 5174, 5179, 5189, 5196, 5207, 5210, 5218, 5230, 5234, 5241, 5254, 5264, 5265, 5278, 5287, 5295, 5303, 5311, 5313, 5321, 5329, 5340, 5348, 5355, 5361, 5370, 5384, 5391, 5395, 5403, 5414, 5421, 5426, 5439, 5443, 5454, 5460, 5466, 5478, 5485, 5492, 5504, 5509, 5515, 5522, 5534, 5543, 5552, 5558, 5565, 5576, 5577, 5585, 5599, 5604, 5609, 5620, 5628, 5633, 5646, 5649, 5658, 5665, 5674, 5688, 5690, 5703, 5709, 5716, 5725, 5730, 5742, 5751, 5759, 5762, 5775, 5782, 5787, 5798, 5806, 5814, 5820, 5829, 5833, 5847, 5849, 5863, 5867, 5876, 5885, 5894, 5899, 5905, 5917, 5923, 5930, 5939, 5952, 5959, 5963, 5971, 5979, 5988, 5996, 6008, 6010, 6017, 6030, 6034, 6044, 6053, 6060, 6070, 6074, 6081, 6095, 6104, 6105, 6117, 6124, 6134, 6137, 6147, 6159, 6168, 6176, 6181, 6192, 6199, 6201, 6209, 6223, 6226, 6239, 6248, 6256, 6260, 6265, 6276, 6288, 6291, 6301, 6306, 6315, 6324, 6329, 6342, 6350, 6354, 6362, 6373, 6381, 6386, 6394, 6408, 6410, 6419, 6431, 6433, 6445, 6455, 6462, 6467, 6473, 6486, 6494, 6502, 6507, 6519, 6525, 6535, 6543, 6551, 6556, 6568, 6569, 6577, 6590, 6594, 6608, 6612, 6622, 6626, 6635, 6646, 6656, 6660, 6671, 6679, 6683, 6690, 6699, 6707, 6719, 6723, 6735, 6740, 6751, 6757, 6765, 6769, 6782, 6788, 6798, 6803, 6814, 6817, 6831, 6835, 6847, 6853, 6863, 6870, 6876, 6884, 6894, 6903, 6906, 6914, 6924, 6933, 6942, 6951, 6960, 6964, 6973, 6979, 6989, 6995, 7008, 7010, 7022, 7030, 7039, 7043, 7056, 7064, 7070, 7078, 7086, 7092, 7104, 7106, 7117, 7124, 7132, 7139, 7148, 7156, 7167, 7174, 7182, 7189, 7199, 7204, 7216, 7220, 7228, 7238, 7248, 7253, 7263, 7270, 7275, 7282, 7291, 7303, 7305, 7313, 7323, 7331, 7339, 7348, 7359, 7368, 7375, 7378, 7389, 7393, 7406, 7415, 7419, 7425, 7437, 7442, 7452, 7461, 7469, 7473, 7485, 7495, 7500, 7508, 7519, 7525, 7534, 7544, 7550, 7555, 7565, 7571, 7584, 7587, 7596, 7608, 7613, 7622, 7626, 7634, 7642, 7654, 7658, 7671, 7674, 7684, 7695, 7704, 7710, 7719, 7728, 7731, 7740, 7750, 7755, 7762, 7770, 7782, 7786, 7796, 7806, 7815, 7818, 7832, 7839, 7842, 7856, 7861, 7867, 7878, 7883, 7895, 7901, 7908, 7915, 7921, 7934, 7942, 7951, 7958, 7963, 7973, 7979, 7986, 7998, 8004, 8012, 8017, 8031, 8039, 8045, 8053, 8061, 8071, 8076, 8086, 8089, 8098, 8111, 8119, 8128, 8132, 8140, 8145, 8153, 8165, 8171, 8181, 8187, 8199, 8208, 8213, 8222, 8231, 8234, 8243, 8249, 8261, 8268, 8273, 8284, 8295, 8298, 8310, 8320, 8321, 8331, 8343, 8347, 8353, 8368, 8375, 8383, 8388, 8399, 8404, 8409, 8423, 8429, 8439, 8441, 8449, 8458, 8468, 8476, 8481, 8496, 8499, 8509, 8514, 8527, 8533, 8538, 8549, 8558, 8568, 8573, 8581, 8591, 8593, 8603, 8616, 8617, 8625, 8634, 8644, 8655, 8662, 8668, 8680, 8685, 8692, 8701, 8710, 8715, 8723, 8735, 8744, 8752, 8758, 8766, 8770, 8780, 8791, 8797, 8806, 8816, 8818, 8826, 8836, 8847, 8850, 8863, 8870, 8880, 8887, 8890, 8904, 8908, 8914, 8926, 8934, 8940, 8947, 8957, 8967, 8976, 8977, 8989, 8999, 9005, 9014, 9023, 9028, 9033, 9043, 9052, 9063, 9067, 9079, 9081, 9094, 9102, 9106, 9116, 9121, 9129, 9141, 9149, 9157, 9164, 9174, 9184, 9190, 9194, 9202, 9214, 9219, 9229, 9239, 9246, 9252, 9262, 9268, 9280, 9288, 9295, 9297, 9308, 9314, 9326, 9333, 9338, 9350, 9359, 9365, 9375, 9381, 9387, 9394, 9401, 9414, 9422, 9425, 9438, 9445, 9454, 9462, 9472, 9477, 9483, 9491, 9500, 9506, 9515, 9526, 9530, 9543, 9545, 9558, 9562, 9571, 9579, 9592, 9600, 9607, 9613, 9620, 9632, 9637, 9645, 9655, 9663, 9668, 9680, 9685, 9690, 9701, 9711, 9715, 9728, 9733, 9743, 9745, 9757, 9763, 9773, 9783, 9790, 9798, 9806, 9809, 9818, 9831, 9835, 9846, 9850, 9858, 9867, 9877, 9883, 9896, 9904, 9910, 9916, 9926, 9934, 9941, 9947, 9953, 9968, 9976, 9982, 9985, 9998, 10007, 10009, 10024, 10030, 10034, 10047, 10054, 10064, 10068, 10074, 10084, 10092, 10104, 10105, 10114, 10123, 10135, 10141, 10145, 10155, 10164, 10175, 10184, 10190, 10199, 10204, 10214, 10221, 10227, 10238, 10246, 10249, 10258, 10271, 10276, 10282, 10294, 10302, 10309, 10317, 10323, 10331, 10343, 10347, 10358, 10368, 10372, 10383, 10389, 10395, 10405, 10416, 10422, 10427, 10435, 10443, 10449, 10463, 10470, 10474, 10482, 10492, 10504, 10507, 10517, 10528, 10536, 10539, 10551, 10556, 10564, 10575, 10584, 10588, 10597, 10605, 10610, 10623, 10632, 10639, 10644, 10654, 10661, 10671, 10678, 10687, 10695, 10698, 10706, 10719, 10727, 10733, 10738, 10750, 10760, 10764, 10776, 10782, 10785, 10800, 10801, 10815, 10824, 10826, 10839, 10847, 10853, 10862, 10871, 10876, 10882, 10891, 10902, 10908, 10919, 10928, 10936, 10942, 10945, 10957, 10966, 10973, 10981, 10992, 10994, 11006, 11013, 11022, 11025, 11036, 11041, 11056, 11062, 11071, 11074, 11085, 11091, 11098, 11107, 11118, 11126, 11130, 11140, 11151, 11160, 11167, 11169, 11179, 11191, 11200, 11202, 11210, 11219, 11228, 11236, 11246, 11249, 11257, 11270, 11275, 11287, 11292, 11302, 11312, 11314, 11324, 11334, 11339, 11346, 11354, 11368, 11369, 11382, 11391, 11395, 11401, 11413, 11419, 11431, 11438, 11447, 11450, 11463, 11468, 11475, 11488, 11492, 11502, 11505, 11516, 11521, 11530, 11542, 11545, 11559, 11565, 11572, 11582, 11591, 11595, 11607, 11611, 11621, 11631, 11634, 11647, 11652, 11663, 11665, 11680, 11681, 11693, 11697, 11707, 11715, 11728, 11734, 11737, 11751, 11760, 11763, 11772, 11780, 11787, 11795, 11802, 11815, 11821, 11827, 11838, 11841, 11849, 11862, 11866, 11873, 11885, 11895, 11898, 11911, 11914, 11925, 11929, 11942, 11948, 11960, 11964, 11970, 11984, 11986, 11993, 12004, 12016, 12024, 12027, 12035, 12042, 12051, 12059, 12069, 12073, 12083, 12095, 12100, 12106, 12119, 12125, 12136, 12139, 12149, 12154, 12164, 12174, 12181, 12189, 12197, 12201, 12210, 12220, 12231, 12233, 12244, 12250, 12262, 12272, 12277, 12284, 12292, 12300, 12305, 12313, 12325, 12334, 12339, 12351, 12354, 12362, 12372, 12380, 12390, 12396, 12402, 12410, 12420, 12432, 12436, 12442, 12456, 12460, 12466, 12476, 12484, 12492, 12501, 12506, 12513, 12521, 12535, 12542, 12552, 12559, 12566, 12571, 12577, 12586, 12593, 12602, 12610, 12621, 12627, 12637, 12644, 12654, 12660, 12670, 12674, 12683, 12692, 12704, 12711, 12720, 12726, 12729, 12744, 12745, 12756, 12761, 12772, 12781, 12786, 12795, 12802, 12810, 12822, 12831, 12836, 12848, 12855, 12864, 12869, 12879, 12887, 12896, 12898, 12906, 12916, 12925, 12930, 12944, 12952, 12957, 12968, 12975, 12983, 12985, 12994, 13006, 13012, 13022, 13026, 13038, 13041, 13050, 13062, 13066, 13079, 13081, 13091, 13098, 13108, 13114, 13125, 13135, 13140, 13149, 13158, 13166, 13175, 13180, 13190, 13200, 13205, 13210, 13219, 13232, 13240, 13247, 13256, 13258, 13268, 13279, 13285, 13289, 13303, 13311, 13313, 13325, 13336, 13344, 13348, 13357, 13364, 13374, 13380, 13392, 13399, 13402, 13411, 13421, 13430, 13437, 13442, 13454, 13463, 13466, 13474, 13484, 13496, 13502, 13509, 13519, 13523, 13536, 13537, 13546, 13558, 13563, 13575, 13579, 13586, 13594, 13603, 13610, 13623, 13632, 13637, 13648, 13652, 13660, 13671, 13678, 13685, 13694, 13703, 13709, 13717, 13724, 13731, 13740, 13747, 13757, 13767, 13776, 13779, 13789, 13795, 13803, 13813, 13821, 13828, 13836, 13841, 13854, 13861, 13865, 13878, 13883, 13890, 13901, 13906, 13920, 13923, 13933, 13937, 13949, 13954, 13966, 13970, 13979, 13987, 14000, 14005, 14014, 14023, 14027, 14034, 14042, 14052, 14057, 14071, 14080, 14086, 14096, 14098, 14109, 14120, 14123, 14136, 14138, 14152, 14160, 14161, 14170, 14177, 14185, 14199, 14202, 14210, 14219, 14232, 14236, 14247, 14254, 14262, 14269, 14280, 14286, 14293, 14301, 14311, 14318, 14327, 14330, 14329]</code></pre><p>Reduce the balanced fully crossed design to the original experimental design:</p><pre><code class="language-julia hljs">fake_kb07_df= fake_kb07_df[idx, :]
rename!(fake_kb07_df, :dv =&gt; :rt_trunc)</code></pre><p>Now we can use the simulated data in the same way as above.</p><p>Set contrasts:</p><pre><code class="language-julia hljs">contrasts = Dict(:spkr =&gt; HelmertCoding(),
                 :prec =&gt; HelmertCoding(),
                 :load =&gt; HelmertCoding(),
                 :item =&gt; Grouping(),
                 :subj =&gt; Grouping());</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Dict{Symbol, StatsModels.AbstractContrasts} with 5 entries:
  :item =&gt; Grouping()
  :spkr =&gt; HelmertCoding(nothing, nothing)
  :load =&gt; HelmertCoding(nothing, nothing)
  :prec =&gt; HelmertCoding(nothing, nothing)
  :subj =&gt; Grouping()</code></pre><p>Define formula, same as above:</p><pre><code class="language-julia hljs">kb07_f = @formula(rt_trunc ~ 1 + spkr + prec + load + (1|subj) + (1+prec|item));</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">FormulaTerm
Response:
  rt_trunc(unknown)
Predictors:
  1
  spkr(unknown)
  prec(unknown)
  load(unknown)
  (subj)-&gt;1 | subj
  (prec,item)-&gt;(1 + prec) | item</code></pre><p>Fit the model:</p><pre><code class="language-julia hljs">fake_kb07_m = fit(MixedModel, kb07_f, fake_kb07_df; contrasts=contrasts)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Linear mixed model fit by maximum likelihood
 rt_trunc ~ 1 + spkr + prec + load + (1 | subj) + (1 + prec | item)
   logLik   -2 logLik     AIC       AICc        BIC    
 -2557.7828  5115.5656  5133.5656  5133.6666  5182.9853

Variance components:
             Column      Variance  Std.Dev.   Corr.
item     (Intercept)     0.0000000 0.0000000
         prec: maintain  0.0000000 0.0000018  +NaN
subj     (Intercept)     0.0002214 0.0148803
Residual                 1.0167123 1.0083215
 Number of obs: 1792; levels of grouping factors: 32, 56

  Fixed-effects parameters:
────────────────────────────────────────────────────────
                      Coef.  Std. Error      z  Pr(&gt;|z|)
────────────────────────────────────────────────────────
(Intercept)     -0.0105881    0.0239192  -0.44    0.6580
spkr: old       -0.0232528    0.0239069  -0.97    0.3307
prec: maintain   0.00750426   0.0238953   0.31    0.7535
load: yes        0.0136265    0.0238451   0.57    0.5677
────────────────────────────────────────────────────────</code></pre><p>Set random seed for reproducibility:</p><pre><code class="language-julia hljs">rng = StableRNG(42);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">StableRNGs.LehmerRNG(state=0x00000000000000000000000000000055)</code></pre><p>Then, again, we specify <code>β</code>, <code>σ</code>, and <code>θ</code>. Here we use the values that we found in the model of the existing dataset:</p><pre><code class="language-julia hljs">#beta
new_beta = [2181.85, 67.879, -333.791, 78.5904] #manual
new_beta = kb07_m.β #grab from existing model

#sigma
new_sigma = 680.032 #manual
new_sigma = kb07_m.σ #grab from existing model

#theta
re_item_corr = [1.0 -0.7; -0.7 1.0]
re_item = create_re(0.536, 0.371; corrmat = re_item_corr)
re_subj = create_re(0.438)
new_theta = createθ(kb07_m; item=re_item, subj=re_subj)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">4-element Vector{Float64}:
  0.536
 -0.2597
  0.26494699469893973
  0.438</code></pre><p>Run nsims iterations:</p><pre><code class="language-julia hljs">fake_kb07_sim = parametricbootstrap(rng, nsims, fake_kb07_m,
                        β = new_beta,
                        σ = new_sigma,
                        θ = new_theta);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">MixedModelBootstrap with 100 samples
      parameter  min        q25        median     mean       q75        ⋯
    ┌────────────────────────────────────────────────────────────────────
 1  │ β1         1999.99    2126.27    2174.94    2175.29    2223.64    ⋯
 2  │ β2         32.2887    59.4361    71.9847    70.5161    83.3956    ⋯
 3  │ β3         183.955    305.506    329.418    331.619    362.811    ⋯
 4  │ β4         37.6805    66.8622    79.7979    79.1976    91.9039    ⋯
 5  │ σ          647.511    670.822    680.682    679.62     688.46     ⋯
 6  │ σ1         207.196    317.105    356.473    353.425    393.227    ⋯
 7  │ σ2         161.908    214.081    238.958    243.762    268.643    ⋯
 8  │ ρ1         -0.93323   -0.789669  -0.695112  -0.697072  -0.622552  ⋯
 9  │ σ3         200.201    268.904    296.578    295.702    323.654    ⋯
 10 │ θ1         0.310352   0.465927   0.526509   0.520172   0.570749   ⋯
 11 │ θ2         -0.424099  -0.29589   -0.250592  -0.252728  -0.202565  ⋯
 12 │ θ3         0.150365   0.214629   0.24831    0.247739   0.28456    ⋯
 13 │ θ4         0.289263   0.395084   0.434852   0.435185   0.475664   ⋯
</code></pre><h3 id="Power-calculation-4"><a class="docs-heading-anchor" href="#Power-calculation-4">Power calculation</a><a class="docs-heading-anchor-permalink" href="#Power-calculation-4" title="Permalink"></a></h3><pre><code class="language-julia hljs">power_table(fake_kb07_sim)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">4-element Vector{@NamedTuple{coefname::String, power::Float64}}:
 (coefname = &quot;(Intercept)&quot;, power = 1.0)
 (coefname = &quot;spkr: old&quot;, power = 0.99)
 (coefname = &quot;prec: maintain&quot;, power = 1.0)
 (coefname = &quot;load: yes&quot;, power = 1.0)</code></pre><p>Compare to the powertable from the existing data:</p><pre><code class="language-julia hljs">power_table(kb07_sim)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">4-element Vector{@NamedTuple{coefname::String, power::Float64}}:
 (coefname = &quot;prec: break&quot;, power = 1.0)
 (coefname = &quot;(Intercept)&quot;, power = 1.0)
 (coefname = &quot;spkr: old&quot;, power = 0.99)
 (coefname = &quot;load: yes&quot;, power = 1.0)</code></pre><p>We have successfully recreated the power simulation of an existing dataset from scratch. This has the advantage, that we now can iterate over different numbers of subjects and items.</p><h2 id="Loop-over-subject-and-item-sizes"><a class="docs-heading-anchor" href="#Loop-over-subject-and-item-sizes">Loop over subject and item sizes</a><a id="Loop-over-subject-and-item-sizes-1"></a><a class="docs-heading-anchor-permalink" href="#Loop-over-subject-and-item-sizes" title="Permalink"></a></h2><p>When designing a study, you may be interested in trying various numbers of subjects and items to see how that affects the power of your study. To do this you can use a loop to run simulations over a range of values for any parameter.</p><h3 id="We-first-define-every-fixed-things-outside-the-loop-(same-as-above):"><a class="docs-heading-anchor" href="#We-first-define-every-fixed-things-outside-the-loop-(same-as-above):">We first define every fixed things outside the loop (same as above):</a><a id="We-first-define-every-fixed-things-outside-the-loop-(same-as-above):-1"></a><a class="docs-heading-anchor-permalink" href="#We-first-define-every-fixed-things-outside-the-loop-(same-as-above):" title="Permalink"></a></h3><p>Define factors in a dict:</p><pre><code class="language-julia hljs">subj_btwn = nothing
item_btwn = nothing
both_win = Dict(:spkr =&gt; [&quot;old&quot;, &quot;new&quot;],
                :prec =&gt; [&quot;maintain&quot;, &quot;break&quot;],
                :load =&gt; [&quot;yes&quot;, &quot;no&quot;]);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Dict{Symbol, Vector{String}} with 3 entries:
  :spkr =&gt; [&quot;old&quot;, &quot;new&quot;]
  :load =&gt; [&quot;yes&quot;, &quot;no&quot;]
  :prec =&gt; [&quot;maintain&quot;, &quot;break&quot;]</code></pre><p>Set contrasts:</p><pre><code class="language-julia hljs">contrasts = Dict(:spkr =&gt; HelmertCoding(),
                 :prec =&gt; HelmertCoding(base=&quot;maintain&quot;),
                 :load =&gt; HelmertCoding());</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Dict{Symbol, StatsModels.HelmertCoding} with 3 entries:
  :spkr =&gt; HelmertCoding(nothing, nothing)
  :load =&gt; HelmertCoding(nothing, nothing)
  :prec =&gt; HelmertCoding(&quot;maintain&quot;, nothing)</code></pre><p>Set random seed for reproducibility:</p><pre><code class="language-julia hljs">rng = StableRNG(42);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">StableRNGs.LehmerRNG(state=0x00000000000000000000000000000055)</code></pre><p>Define formula:</p><pre><code class="language-julia hljs">kb07_f = @formula(rt_trunc ~ 1 + spkr + prec + load + (1 | subj) + (1 + prec | item));</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">FormulaTerm
Response:
  rt_trunc(unknown)
Predictors:
  1
  spkr(unknown)
  prec(unknown)
  load(unknown)
  (subj)-&gt;1 | subj
  (prec,item)-&gt;(1 + prec) | item</code></pre><p>a Specify <code>β</code>, <code>σ</code>, and <code>θ</code>:</p><pre><code class="language-julia hljs">#beta
new_beta = [2181.85, 67.879, -333.791, 78.5904]
new_beta = kb07_m.β

#sigma
new_sigma = 680.032
new_sigma = kb07_m.σ

#theta
re_item_corr = [1.0 -0.7; -0.7 1.0]
re_item = create_re(0.536, 0.371; corrmat = re_item_corr)
re_subj = create_re(0.438)
# because the ordering in theta is dependent on the design,
# we will create it within the loop as we change the design parameters
# (e.g. n subjects and n items)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×1 LinearAlgebra.LowerTriangular{Float64, LinearAlgebra.Diagonal{Float64, Vector{Float64}}}:
 0.438</code></pre><h3 id="Then-we-define-the-variables-that-out-loop-will-iterate-over"><a class="docs-heading-anchor" href="#Then-we-define-the-variables-that-out-loop-will-iterate-over">Then we define the variables that out loop will iterate over</a><a id="Then-we-define-the-variables-that-out-loop-will-iterate-over-1"></a><a class="docs-heading-anchor-permalink" href="#Then-we-define-the-variables-that-out-loop-will-iterate-over" title="Permalink"></a></h3><p>Define subject and item numbers as arrays:</p><pre><code class="language-julia hljs">sub_ns = [20, 30, 40];
item_ns = [16, 24, 32];</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3-element Vector{Int64}:
 16
 24
 32</code></pre><p>Make an empty dataframe:</p><pre><code class="language-julia hljs">d = DataFrame();</code></pre><h3 id="Run-the-loop:"><a class="docs-heading-anchor" href="#Run-the-loop:">Run the loop:</a><a id="Run-the-loop:-1"></a><a class="docs-heading-anchor-permalink" href="#Run-the-loop:" title="Permalink"></a></h3><pre><code class="language-julia hljs">@showprogress for subj_n in sub_ns, item_n in item_ns
    # Make balanced fully crossed data:
    fake = simdat_crossed(subj_n, item_n;
                          subj_btwn = subj_btwn,
                          item_btwn = item_btwn,
                          both_win = both_win);
    fake_df = DataFrame(fake)

    # Reduce the balanced fully crossed design to the original experimental design:
    fake_df = sort(fake_df, [:subj, :item, :load, :prec, :spkr])
    local len = convert(Int64,(length(fake)/8))
    local idx = rand(rng, collect(1:8) , len)
    local A = repeat([8], inner=len-1)
    push!(A, 0)
    A = cumsum(A)
    idx = idx + A
    fake_df = fake_df[idx, :]
    rename!(fake_df, :dv =&gt; :rt_trunc)

    # create the model:
    fake_m = LinearMixedModel(kb07_f, fake_df, contrasts=contrasts);
    local new_theta = createθ(fake_m; item=re_item, subj=re_subj)
    # Run nsims iterations:
    fake_sim = parametricbootstrap(rng, nsims, fake_m,
                                   β = new_beta,
                                   σ = new_sigma,
                                   θ = new_theta,
                                   progress=false);

    # Power calculation
    local ptbl = power_table(fake_sim)
    ptdf = DataFrame(ptbl)
    ptdf[!, :item_n] .= item_n
    ptdf[!, :subj_n] .= subj_n
    append!(d, ptdf)
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr32">Progress:  67%|███████████████████████████▍             |  ETA: 0:00:01</span><span class="sgr32">Progress: 100%|█████████████████████████████████████████| Time: 0:00:04</span></code></pre><p>Our dataframe <code>d</code> now contains the power information for each combination of subjects and items.</p><pre><code class="language-julia hljs">first(d, 10)</code></pre><div><div style = "float: left;"><span>10×4 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">coefname</th><th style = "text-align: left;">power</th><th style = "text-align: left;">item_n</th><th style = "text-align: left;">subj_n</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Int64" style = "text-align: left;">Int64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">prec: break</td><td style = "text-align: right;">0.99</td><td style = "text-align: right;">16</td><td style = "text-align: right;">20</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">(Intercept)</td><td style = "text-align: right;">1.0</td><td style = "text-align: right;">16</td><td style = "text-align: right;">20</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">spkr: old</td><td style = "text-align: right;">0.43</td><td style = "text-align: right;">16</td><td style = "text-align: right;">20</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">load: yes</td><td style = "text-align: right;">0.49</td><td style = "text-align: right;">16</td><td style = "text-align: right;">20</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">prec: break</td><td style = "text-align: right;">1.0</td><td style = "text-align: right;">24</td><td style = "text-align: right;">20</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">(Intercept)</td><td style = "text-align: right;">1.0</td><td style = "text-align: right;">24</td><td style = "text-align: right;">20</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">spkr: old</td><td style = "text-align: right;">0.59</td><td style = "text-align: right;">24</td><td style = "text-align: right;">20</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: left;">load: yes</td><td style = "text-align: right;">0.63</td><td style = "text-align: right;">24</td><td style = "text-align: right;">20</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: left;">prec: break</td><td style = "text-align: right;">1.0</td><td style = "text-align: right;">32</td><td style = "text-align: right;">20</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">10</td><td style = "text-align: left;">(Intercept)</td><td style = "text-align: right;">1.0</td><td style = "text-align: right;">32</td><td style = "text-align: right;">20</td></tr></tbody></table></div><p>Lastly we plot our results:</p><pre><code class="language-julia hljs">function subplot_power(f::Figure, dat, coefname)
    coefpow = @subset(dat, :coefname == coefname)
    ax = Axis(f;
              xlabel=&quot;n subjects&quot;,
              ylabel=&quot;n items&quot;,
              #aspect=AxisAspect(1),
              title=&quot;$(coefname)&quot;)
    heatmap!(ax, coefpow.subj_n, coefpow.item_n, coefpow.power; colorrange=[0,1])
    return ax
end

fig = Figure(; resolution=(1300,300))
for (idx, cn) in enumerate(sort(unique(d.coefname)))
    fig[1, idx] = subplot_power(fig, d, cn)
end
Colorbar(fig[1, end+1]; label=&quot;power&quot;, vertical=true, colorrange=[0,1], colormap=:viridis)
fig</code></pre><img src="a5ffa0a7.svg" alt="Example block output"/><h2 id="Acknowledgements"><a class="docs-heading-anchor" href="#Acknowledgements">Acknowledgements</a><a id="Acknowledgements-1"></a><a class="docs-heading-anchor-permalink" href="#Acknowledgements" title="Permalink"></a></h2><p>The text here is based on a tutorial presented at a ZiF workshop by Lisa DeBruine (Feb. 2020) and presented again by Phillip Alday during the SMLP Summer School (Sep. 2020).</p><p>Updated and extended by Lisa Schwetlick &amp; Daniel Backhaus, with the kind help of Phillip Alday, after changes to the package.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../simulation/">« Rapid Start</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 2 September 2025 12:59">Tuesday 2 September 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
